var W=Object.defineProperty;var w=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var T=(m,i,t)=>i in m?W(m,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):m[i]=t,q=(m,i)=>{for(var t in i||(i={}))j.call(i,t)&&T(m,t,i[t]);if(w)for(var t of w(i))F.call(i,t)&&T(m,t,i[t]);return m};var f=(m,i,t)=>new Promise((D,r)=>{var $=l=>{try{k(t.next(l))}catch(b){r(b)}},C=l=>{try{k(t.throw(l))}catch(b){r(b)}},k=l=>l.done?D(l.value):Promise.resolve(l.value).then($,C);k((t=t.apply(m,i)).next())});import{bl as G,aq as L,al as M}from"./bootstrap-CbEyMBZc.js";import{v as H,a as J}from"./vxe-table-5UTMlFMN.js";import{u as K,t as Q,a as X,b as Z,c as A,d as ee,e as te}from"./tenant-CHGD6Hfo.js";import"./vuedraggable.umd-Cwsj9bYW.js";import{_ as ne}from"./table-switch.vue_vue_type_script_setup_true_lang-DjGnwzfb.js";import{c as ae}from"./download-BL_xY_mD.js";import{c as oe,q as ie,t as se}from"./tenant-drawer-Bmazwrjf.js";import V from"./index-Yd03BW_o.js";import{_ as re}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{_ as me}from"./fallback.vue_vue_type_script_setup_true_lang-ChoFPR3D.js";import{d as ce,B as pe,l as Y,V as de,h as p,o as d,w as o,a as h,b as n,f as le,W as g,k as y,t as _}from"../jse/index-index-CKHiV3bJ.js";import{u as ue}from"./use-vxe-grid-jJsowVf7.js";import{u as fe}from"./use-drawer-ZsTa9Rf6.js";import{P}from"./index-Bf3KtG2n.js";import{g as B}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./index-CzyoVQCf.js";import"./index-DM1WbR0K.js";import"./popup-DepLi2Z4.js";import"./rotate-cw-D3jx6xYy.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";const Le=ce({__name:"index",setup(m){const i={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:ie(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["expireTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},t={checkboxConfig:{highlight:!0,reserve:!0,checkMethod:({row:e})=>(e==null?void 0:e.id)!==1},columns:oe,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(x,...u)=>f(null,[x,...u],function*({page:e,sorts:a},c={}){const s=q({pageNum:e.currentPage,pageSize:e.pageSize},c);return J(s,a),yield X(s)})}},rowConfig:{keyField:"id"},sortConfig:{remote:!0,multiple:!1},id:"system-tenant-index"},[D,r]=ue({formOptions:i,gridOptions:t,gridEvents:{sortChange:()=>r.query()}}),[$,C]=fe({connectedComponent:se});function k(){C.setData({}),C.open()}function l(e){return f(this,null,function*(){C.setData({id:e.id}),C.open()})}function b(e){return f(this,null,function*(){const{tenantId:a,packageId:c}=e;yield Z(a,c),yield r.query()})}const S=K();function E(e){return f(this,null,function*(){yield A([e.id]),yield r.query(),S.initTenant()})}function N(){const a=r.grid.getCheckboxRecords().map(c=>c.id);M.confirm({title:"提示",okType:"danger",content:`确认删除选中的${a.length}条记录吗？`,onOk:()=>f(null,null,function*(){yield A(a),yield r.query(),S.initTenant()})})}function R(){ae(ee,"租户数据",r.formApi.form.values)}const{hasAccessByCodes:O,hasAccessByRoles:z}=G(),I=pe(()=>z(["superadmin"]));function U(){M.confirm({title:"提示",iconType:"warning",content:"确认同步租户字典？",onOk:()=>f(null,null,function*(){yield te(),yield r.query()})})}return(e,a)=>{const c=Y("a-button"),x=Y("ghost-button"),u=de("access");return I.value?(d(),p(n(re),{key:0,"auto-content-height":!0},{default:o(()=>[h(n(D),{"table-title":"租户列表"},{"toolbar-tools":o(()=>[h(n(V),null,{default:o(()=>[g((d(),p(c,{onClick:U},{default:o(()=>a[3]||(a[3]=[y(" 同步租户字典 ")])),_:1,__:[3]})),[[u,["system:tenant:edit"],"code"]]),g((d(),p(c,{onClick:R},{default:o(()=>[y(_(e.$t("pages.common.export")),1)]),_:1})),[[u,["system:tenant:export"],"code"]]),g((d(),p(c,{disabled:!n(H)(n(r)),danger:"",type:"primary",onClick:N},{default:o(()=>[y(_(e.$t("pages.common.delete")),1)]),_:1},8,["disabled"])),[[u,["system:tenant:remove"],"code"]]),g((d(),p(c,{type:"primary",onClick:k},{default:o(()=>[y(_(e.$t("pages.common.add")),1)]),_:1})),[[u,["system:tenant:add"],"code"]])]),_:1})]),status:o(({row:s})=>[h(n(ne),{value:s.status,"onUpdate:value":v=>s.status=v,api:()=>n(Q)(s),disabled:s.id===1||!n(O)(["system:tenant:edit"]),onReload:a[0]||(a[0]=v=>n(r).query())},null,8,["value","onUpdate:value","api","disabled"])]),action:o(({row:s})=>[s.id!==1?(d(),p(n(V),{key:0},{default:o(()=>[g((d(),p(x,{onClick:v=>l(s)},{default:o(()=>[y(_(e.$t("pages.common.edit")),1)]),_:2},1032,["onClick"])),[[u,["system:tenant:edit"],"code"]]),h(n(P),{"get-popup-container":n(B),title:`确认同步[${s.companyName}]的套餐吗?`,placement:"left",onConfirm:v=>b(s)},{default:o(()=>[g((d(),p(x,{class:"btn-success"},{default:o(()=>[y(_(e.$t("pages.common.sync")),1)]),_:1})),[[u,["system:tenant:edit"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"]),h(n(P),{"get-popup-container":n(B),placement:"left",title:"确认删除？",onConfirm:v=>E(s)},{default:o(()=>[g((d(),p(x,{danger:"",onClick:a[1]||(a[1]=L(()=>{},["stop"]))},{default:o(()=>[y(_(e.$t("pages.common.delete")),1)]),_:1})),[[u,["system:tenant:remove"],"code"]])]),_:2},1032,["get-popup-container","onConfirm"])]),_:2},1024)):le("",!0)]),_:1}),h(n($),{onReload:a[2]||(a[2]=s=>n(r).query())})]),_:1})):(d(),p(n(me),{key:1,description:"您没有租户的访问权限",status:"403"}))}}});export{Le as default};
