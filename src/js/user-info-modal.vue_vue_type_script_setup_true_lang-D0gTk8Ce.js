var I=(x,g,f)=>new Promise((a,v)=>{var h=t=>{try{o(f.next(t))}catch(e){v(e)}},b=t=>{try{o(f.throw(t))}catch(e){v(e)}},o=t=>t.done?a(t.value):Promise.resolve(t.value).then(h,b);o((f=f.apply(x,g)).next())});import{d as z,X as m,C as A,B as y,h as p,o as n,w as s,f as D,b as l,a as r,k as i,t as u,P as E,c as _,F as C,O as T,j as M}from"../jse/index-index-CKHiV3bJ.js";import{d as $,r as j}from"./relativeTime-C5B3Wg5z.js";import{f as F}from"./index-CoycSe17.js";import{r as P}from"./render-C2mFGEaj.js";import{D as R,a as d}from"./index-vRRmcGk_.js";import{T as k}from"./index-D7oCs85i.js";import{u as U}from"./use-modal-BtBQhM0d.js";import{ap as X}from"./bootstrap-CbEyMBZc.js";const Y={key:0,class:"flex flex-wrap gap-0.5"},q={key:1},G={key:0,class:"flex flex-wrap gap-0.5"},H={key:1},te=z({__name:"user-info-modal",setup(x){m.extend($),m.extend(j);const[g,f]=U({onOpenChange:v,onClosed(){a.value=null}}),a=A(null);function v(o){return I(this,null,function*(){if(!o)return null;f.modalLoading(!0);const{userId:t}=f.getData(),e=yield F(t),{postIds:B=[],posts:w=[],roleIds:L=[],roles:S=[],user:N}=e,V=w.filter(c=>B.includes(c.postId)).map(c=>c.postName),O=S.filter(c=>L.includes(c.roleId)).map(c=>c.roleName);N.postNames=V,N.roleNames=O,a.value=N,f.modalLoading(!1)})}const h=y(()=>{if(!a.value)return"-";const{deptName:o,nickName:t,userName:e}=a.value;return`${e} / ${t} / ${o!=null?o:"-"}`}),b=y(()=>{if(!a.value)return"-";const{loginDate:o}=a.value;m.locale("zh-cn");const t=m().diff(m(o),"second");return m.duration(t,"seconds").humanize()});return(o,t)=>(n(),p(l(g),{footer:!1,"fullscreen-button":!1,title:"用户信息"},{default:s(()=>[a.value?(n(),p(l(R),{key:0,size:"small",column:1,bordered:""},{default:s(()=>[r(l(d),{label:"userId"},{default:s(()=>[i(u(a.value.userId),1)]),_:1}),r(l(d),{label:"用户状态"},{default:s(()=>[(n(),p(E(l(P)(a.value.status,l(X).SYS_NORMAL_DISABLE))))]),_:1}),r(l(d),{label:"用户信息"},{default:s(()=>[i(u(h.value),1)]),_:1}),r(l(d),{label:"手机号"},{default:s(()=>[i(u(a.value.phonenumber||"-"),1)]),_:1}),r(l(d),{label:"邮箱"},{default:s(()=>[i(u(a.value.email||"-"),1)]),_:1}),r(l(d),{label:"岗位"},{default:s(()=>[a.value.postNames.length>0?(n(),_("div",Y,[(n(!0),_(C,null,T(a.value.postNames,e=>(n(),p(l(k),{key:e},{default:s(()=>[i(u(e),1)]),_:2},1024))),128))])):(n(),_("span",q,"-"))]),_:1}),r(l(d),{label:"权限"},{default:s(()=>[a.value.roleNames.length>0?(n(),_("div",G,[(n(!0),_(C,null,T(a.value.roleNames,e=>(n(),p(l(k),{key:e},{default:s(()=>[i(u(e),1)]),_:2},1024))),128))])):(n(),_("span",H,"-"))]),_:1}),r(l(d),{label:"创建时间"},{default:s(()=>[i(u(a.value.createTime),1)]),_:1}),r(l(d),{label:"上次登录IP"},{default:s(()=>{var e;return[i(u((e=a.value.loginIp)!=null?e:"-"),1)]}),_:1}),r(l(d),{label:"上次登录时间"},{default:s(()=>{var e;return[M("span",null,u((e=a.value.loginDate)!=null?e:"-"),1),b.value?(n(),p(l(k),{key:0,class:"ml-2",bordered:!1,color:"processing"},{default:s(()=>[i(u(b.value)+"前 ",1)]),_:1})):D("",!0)]}),_:1}),r(l(d),{label:"备注"},{default:s(()=>{var e;return[i(u((e=a.value.remark)!=null?e:"-"),1)]}),_:1})]),_:1})):D("",!0)]),_:1}))}});export{te as _};
