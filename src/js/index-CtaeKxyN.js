var G=Object.defineProperty;var A=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var w=(l,a,r)=>a in l?G(l,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[a]=r,R=(l,a)=>{for(var r in a||(a={}))K.call(a,r)&&w(l,r,a[r]);if(A)for(var r of A(a))U.call(a,r)&&w(l,r,a[r]);return l};var b=(l,a,r)=>new Promise(($,s)=>{var D=p=>{try{k(r.next(p))}catch(v){s(v)}},f=p=>{try{k(r.throw(p))}catch(v){s(v)}},k=p=>p.done?$(p.value):Promise.resolve(p.value).then(D,f);k((r=r.apply(l,a)).next())});import{bl as W,aG as L,aq as q,al as H}from"./bootstrap-CbEyMBZc.js";import{v as J}from"./vxe-table-5UTMlFMN.js";import{h as Q,i as X,j as I,k as Z}from"./index-BT9g_NIp.js";import"./vuedraggable.umd-Cwsj9bYW.js";import{_ as ee}from"./table-switch.vue_vue_type_script_setup_true_lang-DjGnwzfb.js";import{c as oe}from"./download-BL_xY_mD.js";import{q as te,c as re}from"./data-cax7S9lw.js";import{_ as ie}from"./role-auth-modal.vue_vue_type_script_setup_true_lang-CQeqRzCu.js";import{_ as ae}from"./role-drawer.vue_vue_type_script_setup_true_lang-D-2YPAfP.js";import T from"./index-Yd03BW_o.js";import{D as ne}from"./index-DWD1gEWB.js";import{M as se,a as V}from"./index-CQDwpHx9.js";import{_ as me}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as le,B as pe,l as S,V as de,h as u,o as d,w as t,a as m,b as o,c as ce,f as ue,F as fe,W as _,k as c,t as h}from"../jse/index-index-CKHiV3bJ.js";import{u as ge}from"./use-vxe-grid-jJsowVf7.js";import{u as ye}from"./use-drawer-ZsTa9Rf6.js";import{u as Ce}from"./use-modal-BtBQhM0d.js";import{P as _e}from"./index-Bf3KtG2n.js";import{g as he}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./index-CzyoVQCf.js";import"./dict-LWP2femj.js";import"./index-D7oCs85i.js";import"./menu-select-table.vue_vue_type_style_index_0_scoped_96b02cc5_lang-BAd8BLc9.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./uniq-DFnFScdj.js";import"./index-1qAxlhJj.js";import"./Checkbox-CpVw4yVS.js";import"./index-CKqqy29x.js";import"./tree-DFBawhPd.js";import"./index-DcmIf06E.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./index-B4Ee8RY3.js";import"./eagerComputed-ClTeoNNc.js";import"./popup-DepLi2Z4.js";import"./index-B7PFKwMa.js";import"./menu-select-table-BHgG0Yrw.js";import"./Group-u_j2Tbqv.js";import"./index-B1E3W4TM.js";import"./Dropdown-CEQGVhtH.js";import"./move-5_ATuUxE.js";import"./slide-BYSN4a27.js";import"./shallowequal-BSzQCceG.js";import"./Overflow-1mM_ifyS.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";const Mo=le({__name:"index",setup(l){const a={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:te(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},r={checkboxConfig:{highlight:!0,reserve:!0,checkMethod:({row:e})=>e.roleId!==1},columns:re,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(g,...x)=>b(null,[g,...x],function*({page:e},i={}){return yield X(R({pageNum:e.currentPage,pageSize:e.pageSize},i))})}},rowConfig:{keyField:"roleId"},id:"system-role-index"},[$,s]=ge({formOptions:a,gridOptions:r}),[D,f]=ye({connectedComponent:ae});function k(){f.setData({}),f.open()}function p(e){return b(this,null,function*(){f.setData({id:e.roleId}),f.open()})}function v(e){return b(this,null,function*(){yield I([e.roleId]),yield s.query()})}function Y(){const i=s.grid.getCheckboxRecords().map(g=>g.roleId);H.confirm({title:"提示",okType:"danger",content:`确认删除选中的${i.length}条记录吗？`,onOk:()=>b(null,null,function*(){yield I(i),yield s.query()})})}function B(){oe(Z,"角色数据",s.formApi.form.values,{fieldMappingTime:a.fieldMappingTime})}const{hasAccessByCodes:E,hasAccessByRoles:P}=W(),N=pe(()=>P(["superadmin"])),[z,M]=Ce({connectedComponent:ie});function F(e){M.setData({id:e.roleId}),M.open()}const O=L();function j(e){O.push(`/system/role-assign/${e.roleId}`)}return(e,i)=>{const g=S("a-button"),x=S("ghost-button"),y=de("access");return d(),u(o(me),{"auto-content-height":!0},{default:t(()=>[m(o($),{"table-title":"角色列表"},{"toolbar-tools":t(()=>[m(o(T),null,{default:t(()=>[_((d(),u(g,{onClick:B},{default:t(()=>[c(h(e.$t("pages.common.export")),1)]),_:1})),[[y,["system:role:export"],"code"]]),_((d(),u(g,{disabled:!o(J)(o(s)),danger:"",type:"primary",onClick:Y},{default:t(()=>[c(h(e.$t("pages.common.delete")),1)]),_:1},8,["disabled"])),[[y,["system:role:remove"],"code"]]),_((d(),u(g,{type:"primary",onClick:k},{default:t(()=>[c(h(e.$t("pages.common.add")),1)]),_:1})),[[y,["system:role:add"],"code"]])]),_:1})]),status:t(({row:n})=>[m(o(ee),{value:n.status,"onUpdate:value":C=>n.status=C,api:()=>o(Q)(n),disabled:n.roleId===1||n.roleKey==="admin"||!o(E)(["system:role:edit"]),onReload:i[0]||(i[0]=C=>o(s).query())},null,8,["value","onUpdate:value","api","disabled"])]),action:t(({row:n})=>[!n.superAdmin&&(n.roleKey!=="admin"||N.value)?(d(),ce(fe,{key:0},[m(o(T),null,{default:t(()=>[_((d(),u(x,{onClick:q(C=>p(n),["stop"])},{default:t(()=>[c(h(e.$t("pages.common.edit")),1)]),_:2},1032,["onClick"])),[[y,["system:role:edit"],"code"]]),m(o(_e),{"get-popup-container":o(he),placement:"left",title:"确认删除？",onConfirm:C=>v(n)},{default:t(()=>[_((d(),u(x,{danger:"",onClick:i[1]||(i[1]=q(()=>{},["stop"]))},{default:t(()=>[c(h(e.$t("pages.common.delete")),1)]),_:1})),[[y,["system:role:remove"],"code"]])]),_:2},1032,["get-popup-container","onConfirm"])]),_:2},1024),m(o(ne),{placement:"bottomRight"},{overlay:t(()=>[m(o(se),null,{default:t(()=>[m(o(V),{key:"1",onClick:C=>F(n)},{default:t(()=>i[4]||(i[4]=[c(" 数据权限 ")])),_:2,__:[4]},1032,["onClick"]),m(o(V),{key:"2",onClick:C=>j(n)},{default:t(()=>i[5]||(i[5]=[c(" 分配用户 ")])),_:2,__:[5]},1032,["onClick"])]),_:2},1024)]),default:t(()=>[_((d(),u(g,{size:"small",type:"link"},{default:t(()=>[c(h(e.$t("pages.common.more")),1)]),_:1})),[[y,"system:role:edit","code"]])]),_:2},1024)],64)):ue("",!0)]),_:1}),m(o(D),{onReload:i[2]||(i[2]=n=>o(s).query())}),m(o(z),{onReload:i[3]||(i[3]=n=>o(s).query())})]),_:1})}}});export{Mo as default};
