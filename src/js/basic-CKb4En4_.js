var j=Object.defineProperty;var R=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var z=(s,t,e)=>t in s?j(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,T=(s,t)=>{for(var e in t||(t={}))F.call(t,e)&&z(s,e,t[e]);if(R)for(var e of R(t))G.call(t,e)&&z(s,e,t[e]);return s};var h=(s,t,e)=>new Promise((n,r)=>{var d=l=>{try{g(e.next(l))}catch(o){r(o)}},v=l=>{try{g(e.throw(l))}catch(o){r(o)}},g=l=>l.done?n(l.value):Promise.resolve(l.value).then(d,v);g((e=e.apply(s,t)).next())});import{cy as J,bl as Q,cz as K,bh as X,b8 as Y,$,an as I,z as ee,b7 as te,ak as ae,bi as oe,aG as se,cA as ne,cB as re}from"./bootstrap-CbEyMBZc.js";import{o as ie}from"./index-cCfXrJ1Q.js";import{u as O,i as le,j as ce}from"./tenant-CHGD6Hfo.js";import{S as ue}from"./index-BQy1gs98.js";import me from"./index-B-PgKNNy.js";import{p as S,y as pe,ak as de,I as fe,a0 as he,d as N,m as ve,u as ge,q as W,B,c as V,o as M,a as p,w as y,b as a,r as we,v as D,C as ye,f as _e,a6 as xe,a2 as P,h as be}from"../jse/index-index-CKHiV3bJ.js";import{u as ke}from"./use-tabs-CTpa-Bfa.js";import{_ as Se}from"./login.vue_vue_type_script_setup_true_lang-CIXcHUkF.js";import{e as Te,N as Ae,i as Ce,_ as Le}from"./layout.vue_vue_type_script_setup_true_lang-D41Vhp9B.js";import{u as $e}from"./use-modal-BtBQhM0d.js";import{_ as Be}from"./avatar.vue_vue_type_script_setup_true_lang-CZ6M6Zo9.js";import"./index-BLUHc0Mr.js";import"./helper-CgBacOxF.js";import"./index-C-6YIAWO.js";import"./BaseInput-B-KbMaIq.js";import"./css-Dmgy8YJo.js";import"./Overflow-1mM_ifyS.js";import"./index-B4Ee8RY3.js";import"./List-CkKZPkf7.js";import"./isMobile-8sZ0LT6r.js";import"./DownOutlined-C0xNNL43.js";import"./SearchOutlined-wPvswOvm.js";import"./move-5_ATuUxE.js";import"./slide-BYSN4a27.js";import"./useMemo-DU68JpYs.js";import"./statusUtils-BVmAuBuf.js";import"./captcha-BaKBsjZO.js";import"./oauth-common-C2O71sxt.js";import"./index-DsCAfKhb.js";import"./oauth-login.vue_vue_type_script_setup_true_lang-GO9h3Zp-.js";import"./index-CGauSucA.js";import"./auth-title-eqCoA6sQ.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./theme-toggle.vue_vue_type_script_setup_true_lang-D5BPS7hn.js";import"./use-drawer-ZsTa9Rf6.js";import"./x-C_lPlK2i.js";import"./TabsList.vue_vue_type_script_setup_true_lang-Cwcm3S5n.js";import"./rotate-cw-D3jx6xYy.js";const b=S(),E=S(!1),L=S({advancedStyle:{colorStops:[{color:"gray",offset:0},{color:"gray",offset:1}],type:"linear"},content:"",contentType:"multi-line-text",globalAlpha:.25,gridLayoutOptions:{cols:2,gap:[20,20],matrix:[[1,0],[0,1]],rows:2},height:200,layout:"grid",rotate:30,width:160});function Ie(){function s(n){return h(this,null,function*(){var d;const{Watermark:r}=yield he(()=>h(null,null,function*(){const{Watermark:v}=yield import("./index.esm-Ofvdfudw.js");return{Watermark:v}}),[]);L.value=T(T({},L.value),n),b.value=new r(L.value),yield(d=b.value)==null?void 0:d.create()})}function t(n){return h(this,null,function*(){var r;b.value?(yield fe(),yield(r=b.value)==null?void 0:r.changeOptions(T(T({},L.value),n))):yield s(n)})}function e(){b.value&&(b.value.destroy(),b.value=void 0)}return E.value||(E.value=!0,pe(()=>{e()})),{destroyWatermark:e,updateWatermark:t,watermark:de(b)}}const Ne=N({name:"LoginExpiredModal",__name:"login-expired-modal",props:ve({avatar:{default:""},zIndex:{default:0},codeLoginPath:{},forgetPasswordPath:{},loading:{type:Boolean},qrCodeLoginPath:{},registerPath:{},showCodeLogin:{type:Boolean},showForgetPassword:{type:Boolean},showQrcodeLogin:{type:Boolean},showRegister:{type:Boolean},showRememberMe:{type:Boolean},showThirdPartyLogin:{type:Boolean},subTitle:{},title:{},submitButtonText:{}},{open:{type:Boolean},openModifiers:{}}),emits:["update:open"],setup(s){const t=s,e=ge(s,"open"),[n,r]=$e();W(()=>e.value,o=>{r.setState({isOpen:o})});const d=B(()=>t.zIndex||l()),v=["ant-message","loading"];function g(o){return v.some(w=>o.classList.contains(w))}function l(){let o=0;return[...document.querySelectorAll("*")].forEach(c=>{const i=window.getComputedStyle(c).getPropertyValue("z-index");i&&!Number.isNaN(Number.parseInt(i))&&!g(c)&&(o=Math.max(o,Number.parseInt(i)))}),o+1}return(o,w)=>(M(),V("div",null,[p(a(n),{closable:!1,"close-on-click-modal":!1,"close-on-press-escape":!1,footer:!1,"fullscreen-button":!1,header:!1,"z-index":d.value,class:"border-none px-10 py-6 text-center shadow-xl sm:w-[600px] sm:rounded-2xl md:h-[unset]"},{default:y(()=>[p(a(Be),{src:o.avatar,class:"mx-auto mb-6 size-20"},null,8,["src"]),p(a(J),{"show-forget-password":!1,"show-register":!1,"show-remember-me":!1,"sub-title":o.$t("authentication.loginAgainSubTitle"),title:o.$t("authentication.loginAgainTitle")},{default:y(()=>[we(o.$slots,"default")]),_:3},8,["sub-title","title"])]),_:3},8,["z-index"])]))}}),Me={key:0,class:"mr-[8px] hidden md:block"},Re=N({__name:"index",setup(s){const{hasAccessByRoles:t}=Q(),e=S(),n=S(),r=O(),{initTenant:d,setChecked:v}=r,{tenantEnable:g,tenantList:l}=K(r),o=B(()=>t(["superadmin"])&&a(g));D(()=>h(null,null,function*(){t(["superadmin"])&&(yield d())}));const w=X(),{closeOtherTabs:c,refreshTab:A,closeAllTabs:i}=ke();function _(m){return h(this,null,function*(){v(m),w.meta.requireHomeRedirect?yield i():(yield c(),yield A())})}const f=Y(),u=ye(),k=S(!1),U=(m,x)=>h(null,null,function*(){var C;if(a(e)!==m)try{k.value=!0,yield le(m),e.value=m,(C=u.value)==null||C.call(u),u.value=I.success(`${$("component.tenantToggle.switch")} ${x.companyName}`),_(!0),setTimeout(()=>f.resetCache())}catch(H){console.error(H)}finally{k.value=!1}});function q(){return h(this,null,function*(){var m;try{k.value=!0,yield ce(),(m=u.value)==null||m.call(u),u.value=I.success($("component.tenantToggle.reset")),e.value="",_(!1),setTimeout(()=>f.resetCache())}catch(x){console.error(x)}finally{k.value=!1}})}function Z(m,x){return x.companyName.toLowerCase().includes(m.toLowerCase())}return(m,x)=>o.value?(M(),V("div",Me,[p(a(me),{value:n.value,"onUpdate:value":x[0]||(x[0]=C=>n.value=C),disabled:k.value,"field-names":{label:"companyName",value:"tenantId"},"filter-option":Z,options:a(l),placeholder:a($)("component.tenantToggle.placeholder"),"dropdown-style":{position:"fixed",zIndex:1024},"allow-clear":"",class:"w-60","show-search":"",onDeselect:q,onSelect:U},xe({_:2},[k.value?{name:"suffixIcon",fn:y(()=>[p(a(ue),{size:"small",spinning:""})]),key:"0"}:void 0]),1032,["value","disabled","options","placeholder"])])):_e("",!0)}}),ze=ee(Re,[["__scopeId","data-v-79240949"]]),St=N({__name:"basic",setup(s){const t=te(),e=ae(),n=oe(),r=se(),{destroyWatermark:d,updateWatermark:v}=Ie(),g=O(),l=B(()=>{const i=[{handler:()=>{r.push("/profile")},icon:ie,text:$("ui.widgets.profile")}];return g.checked&&i.splice(1,1),i}),o=B(()=>{var i;return((i=t.userInfo)==null?void 0:i.avatar)||P.app.defaultAvatar});function w(){return h(this,null,function*(){yield e.logout(!1),re()})}const c=ne();D(()=>c.startListeningMessage());function A(){I.warning("暂未开放")}return W(()=>P.app.watermark,i=>h(null,null,function*(){var _,f;i?yield v({content:`${(_=t.userInfo)==null?void 0:_.username} - ${(f=t.userInfo)==null?void 0:f.realName}`}):d()}),{immediate:!0}),(i,_)=>(M(),be(a(Le),{onClearPreferencesAndLogout:w},{"header-right-1":y(()=>[p(a(ze))]),"user-dropdown":y(()=>{var f,u;return[p(a(Ce),{avatar:o.value,menus:l.value,text:(f=a(t).userInfo)==null?void 0:f.realName,description:(u=a(t).userInfo)==null?void 0:u.email,"tag-text":"Pro",onLogout:w},null,8,["avatar","menus","text","description"])]}),notification:y(()=>[p(a(Ae),{dot:a(c).showDot,notifications:a(c).notifications,onClear:a(c).clearAllMessage,onMakeAll:a(c).setAllRead,onRead:a(c).setRead,onViewAll:A},null,8,["dot","notifications","onClear","onMakeAll","onRead"])]),extra:y(()=>[p(a(Ne),{open:a(n).loginExpired,"onUpdate:open":_[0]||(_[0]=f=>a(n).loginExpired=f),avatar:o.value},{default:y(()=>[p(Se)]),_:1},8,["open","avatar"])]),"lock-screen":y(()=>[p(a(Te),{avatar:o.value,onToLogin:w},null,8,["avatar"])]),_:1}))}});export{St as default};
