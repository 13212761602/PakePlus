var C=(o,b,c)=>new Promise((d,g)=>{var f=n=>{try{v(c.next(n))}catch(l){g(l)}},t=n=>{try{v(c.throw(n))}catch(l){g(l)}},v=n=>n.done?d(n.value):Promise.resolve(n.value).then(f,t);v((c=c.apply(o,b)).next())});import{y,$ as u,ao as B,bn as T,ap as S}from"./bootstrap-CbEyMBZc.js";import{Tinymce as M}from"./index-DJpumY_N.js";import{g as V}from"./dict-LWP2femj.js";import{u as N}from"./popup-DepLi2Z4.js";import{p as x}from"./pick-DDCWWYz_.js";import"./index-Bo5G3-h7.js";import{I as E}from"./Search-BSSOOXXu.js";import{d as G,p as R,B as z,S as A,h as L,o as W,w as p,a as i,b as e,j as Y,R as _}from"../jse/index-index-CKHiV3bJ.js";import{u as j}from"./use-modal-BtBQhM0d.js";import{a as k}from"./Group-u_j2Tbqv.js";function re(o){return y.get("/system/notice/list",{params:o})}function P(o){return y.get(`/system/notice/${o}`)}function J(o){return y.postWithMsg("/system/notice",o)}function H(o){return y.putWithMsg("/system/notice",o)}function ue(o){return y.deleteWithMsg(`/system/notice/${o}`)}const K={class:"grid sm:grid-cols-1 lg:grid-cols-2"},ce=G({__name:"notice-modal",emits:["reload"],setup(o,{emit:b}){const c=b,d=R(!1),g=z(()=>d.value?u("pages.common.edit"):u("pages.common.add")),f={noticeId:void 0,noticeTitle:"",status:"0",noticeType:"1",noticeContent:""},t=R(f),v=R({status:[{required:!0,message:u("ui.formRules.selectRequired")}],noticeContent:[{required:!0,message:u("ui.formRules.required")}],noticeType:[{required:!0,message:u("ui.formRules.selectRequired")}],noticeTitle:[{required:!0,message:u("ui.formRules.required")}]}),{validate:n,validateInfos:l,resetFields:w}=B.useForm(t,v);function q(){return JSON.stringify(t.value)}const{onBeforeClose:U,markInitialized:$,resetInitialized:I}=N({initializedGetter:q,currentGetter:q}),[D,m]=j({class:"w-[800px]",fullscreenButton:!0,onBeforeClose:U,onClosed:h,onConfirm:O,onOpenChange:r=>C(null,null,function*(){if(!r)return null;m.modalLoading(!0);const{id:a}=m.getData();if(d.value=!!a,d.value&&a){const s=yield P(a),F=x(s,Object.keys(f));t.value=F}yield $(),m.modalLoading(!1)})});function O(){return C(this,null,function*(){try{m.lock(!0),yield n();const r=A(t.value);yield d.value?H(r):J(r),I(),c("reload"),m.close()}catch(r){console.error(r)}finally{m.lock(!1)}})}function h(){return C(this,null,function*(){t.value=f,w(),I()})}return(r,a)=>(W(),L(e(D),{title:g.value},{default:p(()=>[i(e(B),{layout:"vertical"},{default:p(()=>[i(e(T),_({label:"公告标题"},e(l).noticeTitle),{default:p(()=>[i(e(E),{placeholder:e(u)("ui.formRules.required"),value:t.value.noticeTitle,"onUpdate:value":a[0]||(a[0]=s=>t.value.noticeTitle=s)},null,8,["placeholder","value"])]),_:1},16),Y("div",K,[i(e(T),_({label:"公告状态"},e(l).status),{default:p(()=>[i(e(k),{"button-style":"solid","option-type":"button",value:t.value.status,"onUpdate:value":a[1]||(a[1]=s=>t.value.status=s),options:e(V)(e(S).SYS_NOTICE_STATUS)},null,8,["value","options"])]),_:1},16),i(e(T),_({label:"公告类型"},e(l).noticeType),{default:p(()=>[i(e(k),{"button-style":"solid","option-type":"button",value:t.value.noticeType,"onUpdate:value":a[2]||(a[2]=s=>t.value.noticeType=s),options:e(V)(e(S).SYS_NOTICE_TYPE)},null,8,["value","options"])]),_:1},16)]),i(e(T),_({label:"公告内容"},e(l).noticeContent),{default:p(()=>[i(e(M),{modelValue:t.value.noticeContent,"onUpdate:modelValue":a[3]||(a[3]=s=>t.value.noticeContent=s)},null,8,["modelValue"])]),_:1},16)]),_:1})]),_:1},8,["title"]))}});export{ce as _,ue as a,re as n};
