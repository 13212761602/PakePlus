var $=Object.defineProperty;var M=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var Y=(e,t,o)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,v=(e,t)=>{for(var o in t||(t={}))V.call(t,o)&&Y(e,o,t[o]);if(M)for(var o of M(t))q.call(t,o)&&Y(e,o,t[o]);return e};var d=(e,t,o)=>new Promise((T,i)=>{var D=n=>{try{p(o.next(n))}catch(m){i(m)}},g=n=>{try{p(o.throw(n))}catch(m){i(m)}},p=n=>n.done?T(n.value):Promise.resolve(n.value).then(D,g);p((o=o.apply(e,t)).next())});import{y as k,ap as S,aq as L,$ as b,al as A}from"./bootstrap-CbEyMBZc.js";import{v as R,a as W}from"./vxe-table-5UTMlFMN.js";import{c as z}from"./helper-CgBacOxF.js";import{c as B}from"./download-BL_xY_mD.js";import{c as F}from"./modal-BjI4MWtR.js";import{g as P}from"./dict-LWP2femj.js";import{r as N}from"./render-C2mFGEaj.js";import{_ as H}from"./operation-preview-drawer.vue_vue_type_script_setup_true_lang-CIyVzKPC.js";import U from"./index-Yd03BW_o.js";import{_ as j}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as G,l as O,V as J,h as u,o as f,w as a,a as y,b as r,W as C,k as w,t as x}from"../jse/index-index-CKHiV3bJ.js";import{u as K}from"./use-vxe-grid-jJsowVf7.js";import{u as Q}from"./use-drawer-ZsTa9Rf6.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./index-Bo5G3-h7.js";import"./Search-BSSOOXXu.js";import"./statusUtils-BVmAuBuf.js";import"./BaseInput-B-KbMaIq.js";import"./index-CWS-moKy.js";import"./SearchOutlined-wPvswOvm.js";import"./index-B4Ee8RY3.js";import"./index-B1E3W4TM.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./data-CsrVBQ4i.js";import"./index-D7oCs85i.js";import"./index-BQy1gs98.js";import"./json-preview.vue_vue_type_style_index_0_lang-D-h_IPZe.js";import"./index-vRRmcGk_.js";import"./x-C_lPlK2i.js";function X(e){return k.get("/monitor/operlog/list",{params:e})}function Z(e){return k.deleteWithMsg(`/monitor/operlog/${e}`)}function ee(){return k.deleteWithMsg("/monitor/operlog/clean")}function oe(e){return z("/monitor/operlog/export",e)}const te=()=>[{component:"Input",fieldName:"title",label:"系统模块"},{component:"Input",fieldName:"operName",label:"操作人员"},{component:"Select",componentProps:{options:P(S.SYS_OPER_TYPE)},fieldName:"businessType",label:"操作类型"},{component:"Input",fieldName:"operIp",label:"操作IP"},{component:"Select",componentProps:{options:P(S.SYS_COMMON_STATUS)},fieldName:"status",label:"状态"},{component:"RangePicker",fieldName:"createTime",label:"操作时间",componentProps:{valueFormat:"YYYY-MM-DD HH:mm:ss"}}],re=[{type:"checkbox",width:60},{field:"title",title:"系统模块"},{title:"操作类型",field:"businessType",slots:{default:({row:e})=>N(e.businessType,S.SYS_OPER_TYPE)}},{field:"operName",title:"操作人员"},{field:"operIp",title:"IP地址"},{field:"operLocation",title:"IP信息"},{field:"status",title:"操作状态",slots:{default:({row:e})=>N(e.status,S.SYS_COMMON_STATUS)}},{field:"operTime",title:"操作日期",sortable:!0},{field:"costTime",title:"操作耗时",sortable:!0,formatter({cellValue:e}){return`${e} ms`}},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",resizable:!1,width:"auto"}],Fe=G({__name:"index",setup(e){const t={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:te(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},o={checkboxConfig:{highlight:!0,reserve:!0,trigger:"row"},columns:re,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(I,..._)=>d(null,[I,..._],function*({page:l,sorts:c},s={}){const h=v({pageNum:l.currentPage,pageSize:l.pageSize},s);return W(h,c),yield X(h)})}},rowConfig:{keyField:"operId"},sortConfig:{remote:!0,multiple:!0},id:"monitor-operlog-index"},[T,i]=K({formOptions:t,gridOptions:o,gridEvents:{sortChange:()=>i.query()}}),[D,g]=Q({connectedComponent:H});function p(l){g.setData({record:l}),g.open()}function n(){F({onValidated:()=>d(null,null,function*(){yield ee(),yield i.reload()})})}function m(){return d(this,null,function*(){const c=i.grid.getCheckboxRecords().map(s=>s.operId);A.confirm({title:"提示",okType:"danger",content:`确认删除选中的${c.length}条操作日志吗？`,onOk:()=>d(null,null,function*(){yield Z(c),yield i.query()})})})}function E(){B(oe,"操作日志",i.formApi.form.values,{fieldMappingTime:t.fieldMappingTime})}return(l,c)=>{const s=O("a-button"),I=O("ghost-button"),_=J("access");return f(),u(r(j),{"auto-content-height":!0},{default:a(()=>[y(r(T),{"table-title":"操作日志列表"},{"toolbar-tools":a(()=>[y(r(U),null,{default:a(()=>[C((f(),u(s,{onClick:n},{default:a(()=>[w(x(r(b)("pages.common.clear")),1)]),_:1})),[[_,["monitor:operlog:remove"],"code"]]),C((f(),u(s,{onClick:E},{default:a(()=>[w(x(r(b)("pages.common.export")),1)]),_:1})),[[_,["monitor:operlog:export"],"code"]]),C((f(),u(s,{disabled:!r(R)(r(i)),danger:"",type:"primary",onClick:m},{default:a(()=>[w(x(r(b)("pages.common.delete")),1)]),_:1},8,["disabled"])),[[_,["monitor:operlog:remove"],"code"]])]),_:1})]),action:a(({row:h})=>[C((f(),u(I,{onClick:L(ie=>p(h),["stop"])},{default:a(()=>[w(x(r(b)("pages.common.preview")),1)]),_:2},1032,["onClick"])),[[_,["monitor:operlog:list"],"code"]])]),_:1}),y(r(D))]),_:1})}}});export{Fe as default};
