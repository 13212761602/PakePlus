var I=Object.defineProperty;var _=Object.getOwnPropertySymbols;var z=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var C=(r,a,t)=>a in r?I(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t,N=(r,a)=>{for(var t in a||(a={}))z.call(a,t)&&C(r,t,a[t]);if(_)for(var t of _(a))M.call(a,t)&&C(r,t,a[t]);return r};import{au as m,$ as A,z as D}from"./bootstrap-CbEyMBZc.js";import{d as T}from"./vuedraggable.umd-Cwsj9bYW.js";import{q as U}from"./data-xOwsLIQf.js";import q from"./index-Yd03BW_o.js";import G from"./index-1qAxlhJj.js";import{d as J,p as h,v as $,B as K,h as L,o as R,w as i,j as f,a as d,b as s,k as u,t as v}from"../jse/index-index-CKHiV3bJ.js";import{u as Y}from"./use-modal-BtBQhM0d.js";import"./Checkbox-CpVw4yVS.js";import"./index-CKqqy29x.js";import"./index-C0ExvxMt.js";import"./x-C_lPlK2i.js";const H={class:"mb-4 flex justify-between"},P={class:"text-gray-500"},Q={class:"h-[300px] overflow-y-auto border rounded p-2"},W={class:"flex items-center py-1 px-2 hover:bg-gray-50 rounded cursor-move"},b="demo_search_field_config",X=J({__name:"field-config-modal",props:{currentConfig:{}},emits:["updateFieldConfig"],setup(r,{expose:a,emit:t}){const k=t,l=h({}),n=h([]);$(()=>{x(),p()});const y=K(()=>Object.values(l.value).filter(o=>o===!0).length);function x(){const o=U();n.value=o.map(e=>({label:typeof e.label=="string"?e.label:e.fieldName,fieldName:e.fieldName}))}function p(){l.value={};try{const o=localStorage.getItem(b);if(o){const e=JSON.parse(o);e&&Object.keys(e).length>0&&(Object.assign(l.value,e),console.log("从本地存储加载配置成功:",l.value))}n.value.forEach(e=>{l.value[e.fieldName]===void 0&&(l.value[e.fieldName]=!0)})}catch(o){console.error("加载字段配置失败:",o),n.value.forEach(e=>{l.value[e.fieldName]=!0})}console.log("配置初始化完成，配置状态:",l.value)}function S(){n.value.forEach(o=>{l.value[o.fieldName]=!0})}function E(){n.value.forEach(o=>{l.value[o.fieldName]=!1})}function F(){n.value.forEach(o=>{l.value[o.fieldName]=!l.value[o.fieldName]})}function O(){const o=N({},l.value);V(o),k("updateFieldConfig",o),g.close()}function V(o){try{localStorage.setItem(b,JSON.stringify(o)),console.log("配置已保存到本地存储")}catch(e){console.error("保存配置到本地存储失败:",e)}}a({loadConfigFromStorage:p});const[w,g]=Y(),B=()=>{console.log("字段顺序已更新:",n.value)};return(o,e)=>(R(),L(s(w),{title:s(A)("搜索字段配置"),width:400},{footer:i(()=>[d(s(m),{onClick:s(g).close},{default:i(()=>e[5]||(e[5]=[u("取消")])),_:1,__:[5]},8,["onClick"]),d(s(m),{type:"primary",onClick:O},{default:i(()=>e[6]||(e[6]=[u("确定")])),_:1,__:[6]})]),default:i(()=>[f("div",null,[f("div",H,[d(s(q),null,{default:i(()=>[d(s(m),{size:"small",onClick:S},{default:i(()=>e[1]||(e[1]=[u("全选")])),_:1,__:[1]}),d(s(m),{size:"small",onClick:E},{default:i(()=>e[2]||(e[2]=[u("清空")])),_:1,__:[2]}),d(s(m),{size:"small",onClick:F},{default:i(()=>e[3]||(e[3]=[u("反选")])),_:1,__:[3]})]),_:1}),f("div",P,"已选择 "+v(y.value)+" / "+v(n.value.length)+" 个字段",1)]),f("div",Q,[d(s(T),{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=c=>n.value=c),"item-key":"fieldName",handle:".drag-handle",onEnd:B,class:"space-y-1"},{item:i(({element:c})=>[f("div",W,[e[4]||(e[4]=f("div",{class:"drag-handle mr-2 cursor-move"},[f("i",{class:"anticon anticon-drag"})],-1)),d(s(G),{checked:l.value[c.fieldName],"onUpdate:checked":j=>l.value[c.fieldName]=j,class:"flex-1"},{default:i(()=>[u(v(c.label),1)]),_:2},1032,["checked","onUpdate:checked"])])]),_:1},8,["modelValue"])])])]),_:1},8,["title"]))}}),ue=D(X,[["__scopeId","data-v-71bee090"]]);export{ue as default};
