var L=(b,d,r)=>new Promise((c,l)=>{var w=n=>{try{f(r.next(n))}catch(m){l(m)}},p=n=>{try{f(r.throw(n))}catch(m){l(m)}},f=n=>n.done?c(n.value):Promise.resolve(n.value).then(w,p);f((r=r.apply(b,d)).next())});import{z as P}from"./bootstrap-CbEyMBZc.js";import{J as $,X as J,m as O,T as W,V as X,h as S,n as z}from"./index-cCfXrJ1Q.js";import{d as A,p as g,a7 as i,af as E,l as R,h as x,o as y,w as V,c as U,f as T,j as k,a as j,b as h,P as G,t as H,k as K}from"../jse/index-index-CKHiV3bJ.js";import{p as Q}from"./index-DOqVB3Lq.js";import{_ as Y}from"./code-mirror.vue_vue_type_script_setup_true_lang-DKbOgWua.js";import{S as Z}from"./index-Bn5n5c2e.js";import{u as ee}from"./use-modal-BtBQhM0d.js";import{T as te}from"./index-DcmIf06E.js";import"./index-BLUHc0Mr.js";import"./helper-CgBacOxF.js";import"./index-C0ExvxMt.js";import"./x-C_lPlK2i.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./index-B4Ee8RY3.js";import"./eagerComputed-ClTeoNNc.js";import"./index-CKqqy29x.js";const ae={key:0,class:"flex gap-[8px]"},oe={class:"h-[calc(100vh-80px)] w-[300px] overflow-y-scroll"},le={class:"flex items-center gap-[16px]"},ne={class:"fixed right-20 top-20"},se=A({__name:"code-preview-modal",setup(b){const d=g([]),r=g("代码预览"),c=g("点击左侧树节点查看代码"),l=g(null),[w,p]=ee({onOpenChange(o){return L(this,null,function*(){if(!o)return q(),null;p.modalLoading(!0);const{tableId:e}=p.getData(),t=yield Q(e);l.value=t;const a=f(Object.keys(t));d.value=a,p.modalLoading(!1)})}});function f(o){const e=[];for(const t of o){const a=t.split("/");let s=e,u="";for(let _=0;_<a.length;_++){const v=a[_];u+=`${v}`,_!==a.length-1&&(u+="/");const N=s.find(I=>I.title===v);if(N)s=N.children||[];else{const I=(v!=null?v:"").replace(".vm",""),D={icon:m(u),key:u,title:I,children:[]};s.push(D),s=D.children}}}return e}const n=[{key:"java",value:i($)},{key:"xml",value:i(J)},{key:"sql",value:i(O)},{key:"ts",value:i(W)},{key:"vue",value:i(X)},{key:"folder",value:i(S)}];function m(o){const e=z,t=S;if(o.endsWith(".vm")){const a=o.slice(0,-3),s=n.find(u=>a.endsWith(u.key));return s?s.value:e}return t}const C=g("html");function B(o){const t=[{language:"ts",type:".ts"},{language:"java",type:".java"},{language:"xml",type:".xml"},{language:"sql",type:"sql"},{language:"vue",type:".vue"}].find(a=>o.includes(a.type));C.value=t?t.language:"html"}function F(o){const[e=""]=o;if(!l.value)return;const t=l.value[e];t&&(B(e),c.value=t,r.value=`代码预览: ${e.replace(".vm","")}`)}function q(){l.value=null,c.value="点击左侧树节点查看代码",r.value="代码预览",C.value="html"}const{copy:M}=E({legacy:!0});return(o,e)=>{const t=R("a-button");return y(),x(h(w),{footer:!1,fullscreen:!0,"fullscreen-button":!1,title:r.value},{default:V(()=>[l.value?(y(),U("div",ae,[k("div",oe,[d.value.length>0?(y(),x(h(te),{key:0,"show-line":{showLeafIcon:!1},"tree-data":d.value,virtual:!1,"default-expand-all":"",onSelect:F},{title:V(({title:a,icon:s})=>[k("div",le,[(y(),x(G(s))),k("span",null,H(a),1)])]),_:1},8,["tree-data"])):T("",!0)]),j(h(Y),{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),language:C.value,class:"h-[calc(100vh-80px)] w-full overflow-y-scroll text-[16px]",readonly:""},null,8,["modelValue","language"]),k("div",ne,[j(t,{onClick:e[1]||(e[1]=a=>h(M)(c.value))},{default:V(()=>e[2]||(e[2]=[K("复制")])),_:1,__:[2]})])])):T("",!0),l.value?T("",!0):(y(),x(h(Z),{key:1,active:""}))]),_:1},8,["title"])}}}),Ve=P(se,[["__scopeId","data-v-5835a094"]]);export{Ve as default};
