var R=Object.defineProperty;var D=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var I=(o,e,t)=>e in o?R(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,S=(o,e)=>{for(var t in e||(e={}))A.call(e,t)&&I(o,t,e[t]);if(D)for(var t of D(e))U.call(e,t)&&I(o,t,e[t]);return o};var p=(o,e,t)=>new Promise((C,w)=>{var a=l=>{try{m(t.next(l))}catch(b){w(b)}},y=l=>{try{m(t.throw(l))}catch(b){w(b)}},m=l=>l.done?C(l.value):Promise.resolve(l.value).then(a,y);m((t=t.apply(o,e)).next())});import{y as x,ap as Y,aq as T,al as B}from"./bootstrap-CbEyMBZc.js";import{v as W}from"./vxe-table-5UTMlFMN.js";import{c as L}from"./helper-CgBacOxF.js";import{c as z}from"./download-BL_xY_mD.js";import{c as j}from"./modal-BjI4MWtR.js";import{g as F}from"./dict-LWP2femj.js";import{b as G,a as K,r as H}from"./render-C2mFGEaj.js";import{_ as J}from"./login-info-modal.vue_vue_type_script_setup_true_lang-Cvs7bpOz.js";import $ from"./index-Yd03BW_o.js";import{_ as Q}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as X,p as Z,l as N,V as oo,h as d,o as f,w as r,a as u,b as s,k as g,t as h,W as _}from"../jse/index-index-CKHiV3bJ.js";import{u as eo}from"./use-vxe-grid-jJsowVf7.js";import{u as to}from"./use-modal-BtBQhM0d.js";import{P as io}from"./index-Bf3KtG2n.js";import{g as no}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./index-Bo5G3-h7.js";import"./Search-BSSOOXXu.js";import"./statusUtils-BVmAuBuf.js";import"./BaseInput-B-KbMaIq.js";import"./index-CWS-moKy.js";import"./SearchOutlined-wPvswOvm.js";import"./index-B4Ee8RY3.js";import"./index-B1E3W4TM.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./data-CsrVBQ4i.js";import"./index-D7oCs85i.js";import"./index-BQy1gs98.js";import"./json-preview.vue_vue_type_style_index_0_lang-D-h_IPZe.js";import"./index-vRRmcGk_.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";function ro(o){return x.get("/monitor/logininfor/list",{params:o})}function ao(o){return L("/monitor/logininfor/export",o)}function P(o){return x.deleteWithMsg(`/monitor/logininfor/${o}`)}function lo(o){return x.get(`/monitor/logininfor/unlock/${o}`,{successMessageMode:"message"})}function so(){return x.deleteWithMsg("/monitor/logininfor/clean")}const mo=()=>[{component:"Input",fieldName:"ipaddr",label:"IP地址"},{component:"Input",fieldName:"userName",label:"用户账号"},{component:"Select",componentProps:{options:F(Y.SYS_COMMON_STATUS)},fieldName:"status",label:"登录状态"},{component:"RangePicker",fieldName:"dateTime",label:"登录日期"}],co=[{type:"checkbox",width:60},{title:"用户账号",field:"userName"},{title:"登录平台",field:"clientKey"},{title:"IP地址",field:"ipaddr"},{title:"IP地点",field:"loginLocation",width:200},{title:"浏览器",field:"browser",slots:{default:({row:o})=>G(o.browser,!0)}},{title:"系统",field:"os",slots:{default:({row:o})=>{let e=o.os;if(e){const t=e.split(" or ");t.length===2&&(e=t[0])}return K(e,!0)}}},{title:"登录结果",field:"status",slots:{default:({row:o})=>H(o.status,Y.SYS_COMMON_STATUS)}},{title:"信息",field:"msg"},{title:"日期",field:"loginTime"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:150}],ee=X({__name:"index",setup(o){const e={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:mo(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["dateTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},t={checkboxConfig:{highlight:!0,reserve:!0,trigger:"row"},columns:co,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(c,...M)=>p(null,[c,...M],function*({page:i},n={}){return yield ro(S({pageNum:i.currentPage,pageSize:i.pageSize},n))})}},rowConfig:{keyField:"infoId"},id:"monitor-logininfo-index"},C=Z(!1),[w,a]=eo({formOptions:e,gridOptions:t,gridEvents:{checkboxChange:i=>{const n=i.$grid.getCheckboxRecords();C.value=n.length===1&&n[0].status==="1"}}}),[y,m]=to({connectedComponent:J});function l(i){m.setData(i),m.open()}function b(){j({onValidated:()=>p(null,null,function*(){yield so(),yield a.reload()})})}function O(i){return p(this,null,function*(){yield P([i.infoId]),yield a.query()})}function V(){const n=a.grid.getCheckboxRecords().map(c=>c.infoId);B.confirm({title:"提示",okType:"danger",content:`确认删除选中的${n.length}条记录吗？`,onOk:()=>p(null,null,function*(){yield P(n),yield a.query()})})}function q(){return p(this,null,function*(){const i=a.grid.getCheckboxRecords();if(i.length!==1)return;const{userName:n}=i[0];yield lo(n),yield a.query(),C.value=!1,a.grid.clearCheckboxRow()})}function E(){z(ao,"登录日志",a.formApi.form.values,{fieldMappingTime:e.fieldMappingTime})}return(i,n)=>{const c=N("a-button"),M=N("ghost-button"),k=oo("access");return f(),d(s(Q),{"auto-content-height":""},{default:r(()=>[u(s(w),{"table-title":"登录日志列表"},{"toolbar-tools":r(()=>[u(s($),null,{default:r(()=>[_((f(),d(c,{onClick:b},{default:r(()=>[g(h(i.$t("pages.common.clear")),1)]),_:1})),[[k,["monitor:logininfor:remove"],"code"]]),_((f(),d(c,{onClick:E},{default:r(()=>[g(h(i.$t("pages.common.export")),1)]),_:1})),[[k,["monitor:logininfor:export"],"code"]]),_((f(),d(c,{disabled:!s(W)(s(a)),danger:"",type:"primary",onClick:V},{default:r(()=>[g(h(i.$t("pages.common.delete")),1)]),_:1},8,["disabled"])),[[k,["monitor:logininfor:remove"],"code"]]),_((f(),d(c,{disabled:!C.value,type:"primary",onClick:q},{default:r(()=>[g(h(i.$t("pages.common.unlock")),1)]),_:1},8,["disabled"])),[[k,["monitor:logininfor:unlock"],"code"]])]),_:1})]),action:r(({row:v})=>[u(s($),null,{default:r(()=>[u(M,{onClick:T(po=>l(v),["stop"])},{default:r(()=>[g(h(i.$t("pages.common.info")),1)]),_:2},1032,["onClick"]),u(s(io),{"get-popup-container":s(no),placement:"left",title:"确认删除?",onConfirm:()=>O(v)},{default:r(()=>[_((f(),d(M,{danger:"",onClick:n[0]||(n[0]=T(()=>{},["stop"]))},{default:r(()=>[g(h(i.$t("pages.common.delete")),1)]),_:1})),[[k,["monitor:logininfor:remove"],"code"]])]),_:2},1032,["get-popup-container","onConfirm"])]),_:2},1024)]),_:1}),u(s(y))]),_:1})}}});export{ee as default};
