var r=(e,i,s)=>new Promise((d,a)=>{var u=t=>{try{p(s.next(t))}catch(l){a(l)}},c=t=>{try{p(s.throw(t))}catch(l){a(l)}},p=t=>t.done?d(t.value):Promise.resolve(t.value).then(u,c);p((s=s.apply(e,i)).next())});import{$ as N}from"./bootstrap-CbEyMBZc.js";import{a as y}from"./index-B7PFKwMa.js";import"./form-DcAycvJX.js";import{a as m}from"./get-popup-container-P4S1sr5h.js";import{a as g,u as P}from"./use-vben-form-CDDuv56b.js";import{d as w,a8 as I,v,h as F,o as S,w as h,a as C,b,e as V,g as q}from"../jse/index-index-CKHiV3bJ.js";import{C as T,R as _}from"./index-CGauSucA.js";import{l as x,a as R}from"./tree-DFBawhPd.js";const D=()=>[{component:"Divider",componentProps:{orientation:"left"},fieldName:"divider1",formItemClass:"col-span-2",label:"基本信息"},{component:"Input",fieldName:"tableName",label:"表名称",rules:"required"},{component:"Input",fieldName:"tableComment",label:"表描述",rules:"required"},{component:"Input",fieldName:"className",label:"实体类名称",rules:"required"},{component:"Input",fieldName:"functionAuthor",label:"作者",rules:"required"},{component:"Divider",componentProps:{orientation:"left"},fieldName:"divider2",formItemClass:"col-span-2",label:"生成信息"},{component:"Select",componentProps:{allowClear:!1,getPopupContainer:m,options:[{label:"单表(增删改查)",value:"crud"},{label:"树表(增删改查)",value:"tree"}]},defaultValue:"crud",fieldName:"tplCategory",label:"模板类型",rules:"selectRequired"},{component:"Select",componentProps:{getPopupContainer:m},dependencies:{show:e=>e.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeCode",helpMessage:"树节点显示的编码字段名， 如: dept_id (相当于id)",label:"树编码字段",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1},dependencies:{show:e=>e.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeParentCode",help:"树节点显示的父编码字段名， 如: parent_Id (相当于parentId)",label:"树父编码字段",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1},dependencies:{show:e=>e.tplCategory==="tree",triggerFields:["tplCategory"]},fieldName:"treeName",help:"树节点的显示名称字段名， 如: dept_name (相当于label)",label:"树名称字段",rules:"selectRequired"},{component:"Input",fieldName:"packageName",help:"生成在哪个java包下, 例如 com.ruoyi.system",label:"生成包路径",rules:"required"},{component:"Input",fieldName:"moduleName",help:"可理解为子系统名，例如 system",label:"生成模块名",rules:"required"},{component:"Input",fieldName:"businessName",help:"可理解为功能英文名，例如 user",label:"生成业务名",rules:"required"},{component:"Input",fieldName:"functionName",help:"用作类描述，例如 用户",label:"生成功能名",rules:"required"},{component:"TreeSelect",componentProps:{allowClear:!1,getPopupContainer:m},defaultValue:0,fieldName:"parentMenuId",label:"上级菜单"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"modal弹窗",value:"modal"},{label:"drawer抽屉",value:"drawer"}],optionType:"button"},help:"自定义功能, 需要后端支持",defaultValue:"modal",fieldName:"popupComponent",label:"弹窗组件类型"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"useVbenForm",value:"useForm"},{label:"antd原生表单",value:"native"}],optionType:"button"},help:`自定义功能, 需要后端支持
复杂(布局, 联动等)表单建议用antd原生表单`,defaultValue:"useForm",fieldName:"formComponent",label:"生成表单类型"},{component:"Divider",componentProps:{orientation:"left"},fieldName:"divider3",formItemClass:"col-span-2",label:"下拉组件配置"},{component:"Switch",fieldName:"isSelect",label:"是否生成下拉组件",help:"开启后将为标记的字段生成下拉选择组件",defaultValue:!1,formItemClass:"col-span-1 w-full",componentProps:{style:{width:"50px"}}},{component:"Select",componentProps:{getPopupContainer:m},dependencies:{show:e=>e.isSelect===!0,triggerFields:["isSelect"]},fieldName:"selectCodeField",helpMessage:"下拉框选项的值字段名，例如：code、id",label:"下拉框编码字段",defaultValue:"code",rules:"selectRequired"},{component:"Select",componentProps:{allowClear:!1},dependencies:{show:e=>e.isSelect===!0,triggerFields:["isSelect"]},fieldName:"selectNameField",helpMessage:"下拉框选项的显示字段名，例如：name、label",label:"下拉框名称字段",defaultValue:"name",rules:"selectRequired"},{component:"RadioGroup",componentProps:{buttonStyle:"solid",options:[{label:"zip压缩包",value:"0"},{label:"自定义路径",value:"1"}],optionType:"button"},defaultValue:"0",fieldName:"genType",help:"默认为zip压缩包下载, 也可以自定义生成路径",label:"生成代码方式"},{component:"Input",defaultValue:"/",dependencies:{show:e=>e.genType==="1",triggerFields:["genType"]},fieldName:"genPathFront",help:'输入绝对路径, 不支持"./"相对路径',label:"前端代码生成路径",rules:g().regex(/^(?:[a-z]:)?(?:\/|(?:\\|\/)[^\\/:*?"<>|\r\n]+)*(?:\\|\/)?$/i,{message:"请输入合法的路径"})},{component:"Input",defaultValue:"/",dependencies:{show:e=>e.genType==="1",triggerFields:["genType"]},fieldName:"genPathBack",help:'输入绝对路径, 不支持"./"相对路径',label:"后端代码生成路径",rules:g().regex(/^(?:[a-z]:)?(?:\/|(?:\\|\/)[^\\/:*?"<>|\r\n]+)*(?:\\|\/)?$/i,{message:"请输入合法的路径"})},{component:"Textarea",fieldName:"remark",formItemClass:"col-span-2 items-baseline",label:"备注"}],G=w({__name:"basic-setting",setup(e,{expose:i}){const s=I("genInfoData"),[d,a]=P({commonConfig:{componentProps:{class:"w-full",formItemClass:"col-span-1"},labelWidth:150},schema:D(),showDefaultActions:!1,wrapperClass:"grid-cols-2"});function u(l){return r(this,null,function*(){const o=l.map(n=>({label:`${n.columnName} | ${n.columnComment}`,value:n.columnName}));a.updateSchema([{componentProps:{options:o},fieldName:"treeCode"},{componentProps:{options:o},fieldName:"treeParentCode"},{componentProps:{options:o},fieldName:"treeName"},{componentProps:{options:o},fieldName:"selectCodeField"},{componentProps:{options:o},fieldName:"selectNameField"}])})}function c(){return r(this,null,function*(){const l=yield y();l.forEach(f=>{f.menuName=N(f.menuName)});const o=x(l,{id:"menuId",pid:"parentId"}),n=[{fullName:N("menu.root"),menuId:0,menuName:N("menu.root"),children:o}];R(n,"menuName"," / "),a.updateSchema([{componentProps:{fieldNames:{label:"menuName",value:"menuId"},listHeight:300,treeData:n,treeDefaultExpandAll:!1,treeDefaultExpandedKeys:[0],treeLine:{showLeafIcon:!1},treeNodeLabelProp:"fullName"},fieldName:"parentMenuId"}])})}v(()=>r(null,null,function*(){const l=s.value;if(yield a.setValues(l),l.options){const{popupComponent:o,formComponent:n}=JSON.parse(l.options);o&&a.setFieldValue("popupComponent",o),n&&a.setFieldValue("formComponent",n)}yield Promise.all([u(l.columns),c()])}));function p(){return r(this,null,function*(){const{valid:l}=yield a.validate();return!!l})}function t(){return r(this,null,function*(){return yield a.getValues()})}return i({validateForm:p,getFormValues:t}),(l,o)=>(S(),F(b(_),{justify:"center"},{default:h(()=>[C(b(T),V(q({xs:24,sm:24,md:20,lg:16,xl:16})),{default:h(()=>[C(b(d))]),_:1},16)]),_:1}))}});export{G as _};
