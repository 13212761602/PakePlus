var v=(e,t,l)=>new Promise((a,n)=>{var u=o=>{try{s(l.next(o))}catch(r){n(r)}},m=o=>{try{s(l.throw(o))}catch(r){n(r)}},s=o=>o.done?a(o.value):Promise.resolve(o.value).then(u,m);s((l=l.apply(e,t)).next())});import"./vxe-table-5UTMlFMN.js";import{g as x}from"./dict-type-DToMJXi_.js";import{r as O}from"./index-DOqVB3Lq.js";import"./index-Bo5G3-h7.js";import{I as y}from"./Search-BSSOOXXu.js";import d from"./index-B-PgKNNy.js";import E from"./index-1qAxlhJj.js";import{a as i,s as C,d as R,a8 as B,c as W,o as q,j as L,b as _}from"../jse/index-index-CKHiV3bJ.js";import{a as c}from"./get-popup-container-P4S1sr5h.js";import{u as k}from"./use-vxe-grid-jJsowVf7.js";const D=["Long","String","Integer","Double","BigDecimal","Date","Boolean","LocalDate","LocalDateTime"],T=[{label:"=",value:"EQ"},{label:"!=",value:"NE"},{label:">",value:"GT"},{label:">=",value:"GE"},{label:"<",value:"LT"},{label:"<=",value:"LE"},{label:"LIKE",value:"LIKE"},{label:"BETWEEN",value:"BETWEEN"}],w=[{label:"文本框",value:"input"},{label:"文本域",value:"textarea"},{label:"下拉框",value:"select"},{label:"外键",value:"foreignKey"},{label:"单选框",value:"radio"},{label:"复选框",value:"checkbox"},{label:"日期控件",value:"datetime"},{label:"图片上传",value:"imageUpload"},{label:"文件上传",value:"fileUpload"},{label:"富文本",value:"editor"}],h=C([{label:"未设置",value:""}]),b=C([{label:"未设置",value:""}]);(function(){return v(this,null,function*(){(yield x()).forEach(a=>{const n={label:`${a.dictName} | ${a.dictType}`,value:a.dictType};h.push(n)}),(yield O({})).rows.forEach(a=>{const n={label:`${a.tableName} | ${a.tableComment}`,value:a.tableName};b.push(n)})})})();function p(e,t){const l=e[t]?"是":"否",a=e[t]?"text-green-500":"text-red-500";return i("span",{class:a},[l])}function f(e,t){return i(E,{checked:e[t],"onUpdate:checked":l=>e[t]=l},null)}const j={columnComment:[{required:!0,message:"请输入"}],javaField:[{required:!0,message:"请输入"}]},N=[{title:"序号",type:"seq",fixed:"left",width:"50",align:"center"},{title:"字段列名",field:"columnName",showOverflow:"tooltip",fixed:"left",minWidth:150},{title:"字段描述",field:"columnComment",minWidth:150,slots:{edit:({row:e})=>i(y,{value:e.columnComment,"onUpdate:value":t=>e.columnComment=t},null)},editRender:{}},{title:"db类型",field:"columnType",minWidth:120,showOverflow:"tooltip"},{title:"Java类型",field:"javaType",minWidth:150,slots:{edit:({row:e})=>{const t=D.map(l=>({label:l,value:l}));return i(d,{class:"w-full",getPopupContainer:c,options:t,value:e.javaType,"onUpdate:value":l=>e.javaType=l},null)}},editRender:{}},{title:"Java属性名",field:"javaField",minWidth:150,showOverflow:"tooltip",slots:{edit:({row:e})=>i(y,{value:e.javaField,"onUpdate:value":t=>e.javaField=t},null)},editRender:{}},{title:"插入",field:"insert",minWidth:80,showOverflow:"tooltip",align:"center",slots:{default:({row:e})=>p(e,"insert"),edit:({row:e})=>f(e,"insert")},editRender:{}},{title:"编辑",field:"edit",showOverflow:"tooltip",align:"center",minWidth:80,slots:{default:({row:e})=>p(e,"edit"),edit:({row:e})=>f(e,"edit")},editRender:{}},{title:"列表",field:"list",showOverflow:"tooltip",align:"center",minWidth:80,slots:{default:({row:e})=>p(e,"list"),edit:({row:e})=>f(e,"list")},editRender:{}},{title:"查询",field:"query",showOverflow:"tooltip",align:"center",minWidth:80,slots:{default:({row:e})=>p(e,"query"),edit:({row:e})=>f(e,"query")},editRender:{}},{title:"查询方式",field:"queryType",showOverflow:"tooltip",align:"center",minWidth:150,slots:{default:({row:e})=>{const t=e.queryType,l=T.find(a=>a.value===t);return l?l.label:t},edit:({row:e})=>i(d,{class:"w-full",getPopupContainer:c,options:T,value:e.queryType,"onUpdate:value":t=>e.queryType=t},null)},editRender:{}},{title:"必填",field:"required",showOverflow:"tooltip",align:"center",minWidth:80,slots:{default:({row:e})=>p(e,"required"),edit:({row:e})=>f(e,"required")},editRender:{}},{title:"显示类型",field:"htmlType",showOverflow:"tooltip",minWidth:150,align:"center",slots:{default:({row:e})=>{const t=e.htmlType,l=w.find(a=>a.value===t);return l?l.label:t},edit:({row:e})=>i(d,{class:"w-full",getPopupContainer:c,options:w,value:e.htmlType,"onUpdate:value":t=>e.htmlType=t},null)},editRender:{}},{title:"字典类型",field:"dictType",showOverflow:"tooltip",minWidth:230,align:"center",titlePrefix:{message:"仅'下拉框', '单选框', '复选框'支持字典类型"},slots:{default:({row:e})=>{const t=e.dictType,l=h.find(a=>a.value===t);return l?l.label:t},edit:({row:e})=>{const t=()=>{e.dictType=""},l=e.htmlType!=="select"&&e.htmlType!=="radio"&&e.htmlType!=="checkbox";return i(d,{allowClear:!0,class:"w-full",disabled:l,getPopupContainer:c,onDeselect:t,options:h,placeholder:"请选择字典类型",value:e.dictType,"onUpdate:value":a=>e.dictType=a,showSearch:!0,filterOption:(a,n)=>n.label.toLowerCase().indexOf(a.toLowerCase())>=0||n.value.toLowerCase().indexOf(a.toLowerCase())>=0},null)}},editRender:{}},{title:"对应表名",field:"foreignTable",showOverflow:"tooltip",minWidth:230,align:"center",titlePrefix:{message:"仅'外键'类型支持选择对应表名"},slots:{default:({row:e})=>{const t=e.foreignTable,l=b.find(a=>a.value===t);return l?l.label:t||"未设置"},edit:({row:e})=>(console.log("编辑时的行数据:",e),i(d,{allowClear:!0,class:"w-full",disabled:e.htmlType!=="foreignKey",getPopupContainer:c,options:b,placeholder:"请选择对应表名",showSearch:!0,value:e.foreignTable,"onUpdate:value":t=>e.foreignTable=t},null))},editRender:{}}],U={class:"flex flex-col gap-[16px]"},F={class:"h-[calc(100vh-200px)] overflow-y-hidden"},M=R({__name:"gen-config",setup(e,{expose:t}){const l=B("genInfoData"),a={columns:N,keepSource:!0,editConfig:{trigger:"click",mode:"cell",showStatus:!0},editRules:j,rowConfig:{keyField:"id",isCurrent:!0},columnConfig:{resizable:!0},proxyConfig:{enabled:!0},toolbarConfig:{enabled:!1},height:"auto",pagerConfig:{enabled:!1},data:l.value.columns},[n,u]=k({gridOptions:a});function m(){return v(this,null,function*(){return!(yield u.grid.validate())})}function s(){var o,r,g;return(g=(r=(o=u==null?void 0:u.grid)==null?void 0:o.getData)==null?void 0:r.call(o))!=null?g:[]}return t({validateTable:m,getTableRecords:s}),(o,r)=>(q(),W("div",U,[L("div",F,[i(_(n))])]))}});export{M as _};
