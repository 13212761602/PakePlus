var q=Object.defineProperty;var J=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var w=(A,a,o)=>a in A?q(A,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):A[a]=o,v=(A,a)=>{for(var o in a||(a={}))H.call(a,o)&&w(A,o,a[o]);if(J)for(var o of J(a))G.call(a,o)&&w(A,o,a[o]);return A};var Q=(A,a,o)=>new Promise((h,n)=>{var f=g=>{try{B(o.next(g))}catch(C){n(C)}},S=g=>{try{B(o.throw(g))}catch(C){n(C)}},B=g=>g.done?h(g.value):Promise.resolve(g.value).then(f,S);B((o=o.apply(A,a)).next())});import{aG as Z,$ as k,aq as _,T as X,c3 as O,an as K,c4 as V,c5 as R,al as W}from"./bootstrap-CbEyMBZc.js";import{v as $,a as ee}from"./vxe-table-5UTMlFMN.js";import{h as oe}from"./index-xDQdt43_.js";import{d as te}from"./download-BL_xY_mD.js";import{_ as ae}from"./file-upload-modal.vue_vue_type_script_setup_true_lang-C8bPkn45.js";import{_ as ne}from"./image-upload-modal.vue_vue_type_script_setup_true_lang-BB1rWJwd.js";import M from"./index-Yd03BW_o.js";import{I as ie}from"./index-CUsW12bK.js";import{S as Ae}from"./index-BQy1gs98.js";import{_ as se}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as le,p as Y,v as re,l as U,V as ce,h as E,o as d,w as i,a as m,b as e,W as p,k as u,t as y,c as ge,j as de}from"../jse/index-index-CKHiV3bJ.js";import{u as me}from"./use-vxe-grid-jJsowVf7.js";import{u as x}from"./use-modal-BtBQhM0d.js";import{P as Ee}from"./index-Bf3KtG2n.js";import{g as Qe}from"./get-popup-container-P4S1sr5h.js";import pe from"./index-CzyoVQCf.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./helper-CgBacOxF.js";import"./file-upload.vue_vue_type_script_setup_true_lang-BfLRmcqh.js";import"./image-upload.vue_vue_type_style_index_0_lang-DnOJk_hf.js";import"./image-upload.vue_vue_type_script_setup_true_lang-BRHs9aw3.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";function D(A,a=!1){const o=["B","KB","MB","GB","TB"];let n=0;for(;A>=1024&&n<o.length-1;)A/=1024,n++;const f=a?0:Math.min(n,3);return`${A.toFixed(f)}${o[n]}`}const ue=()=>[{component:"Input",fieldName:"fileName",label:"文件名"},{component:"Input",fieldName:"originalName",label:"原名"},{component:"Input",fieldName:"fileSuffix",label:"拓展名"},{component:"Input",fieldName:"service",label:"服务商"},{component:"RangePicker",fieldName:"createTime",label:"创建时间"}],fe=[{type:"checkbox",width:60},{title:"文件名",field:"fileName",showOverflow:!0},{title:"文件原名",field:"originalName",showOverflow:!0},{title:"文件拓展名",field:"fileSuffix"},{title:"文件预览",field:"url",showOverflow:!0,slots:{default:"url"}},{title:"创建时间",field:"createTime",sortable:!0},{title:"上传人",field:"createByName"},{title:"服务商",field:"service"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",resizable:!1,width:"auto"}],Be="data:image/png;base64,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",Ce={class:"flex size-full items-center justify-center"},he={key:1},$e=le({__name:"index",setup(A){const a={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:ue(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["createTime",["params[beginCreateTime]","params[endCreateTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},o={checkboxConfig:{highlight:!0,reserve:!0},columns:fe,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(N,...c)=>Q(null,[N,...c],function*({page:l,sorts:t},r={}){const s=v({pageNum:l.currentPage,pageSize:l.pageSize},r);return ee(s,t),yield O(s)})}},headerCellConfig:{height:44},cellConfig:{height:65},rowConfig:{keyField:"ossId"},sortConfig:{remote:!0,multiple:!1},id:"system-oss-index"},[h,n]=me({formOptions:a,gridOptions:o,gridEvents:{sortChange:()=>n.query()}});function f(l){return Q(this,null,function*(){const t=Y(k("pages.common.downloadLoading")),r=K.loading({content:()=>t.value,duration:0});try{const N=yield V(l.ossId,c=>{const s=Math.floor(c.loaded/c.total*100),b=D(c.loaded),F=D(c.total);t.value=`已下载: ${b}/${F} (${s}%)`});te(N,l.originalName),K.success("下载完成")}finally{r()}})}function S(l){return Q(this,null,function*(){yield R([l.ossId]),yield n.query()})}function B(){const t=n.grid.getCheckboxRecords().map(r=>r.ossId);W.confirm({title:"提示",okType:"danger",content:`确认删除选中的${t.length}条记录吗？`,onOk:()=>Q(null,null,function*(){yield R(t),yield n.query()})})}const g=Z();function C(){g.push("/system/oss-config")}const I=Y(!1);re(()=>Q(null,null,function*(){const l=yield oe("sys.oss.previewListResource");I.value=l==="true"}));function j(l){return["jpg","jpeg","png","gif","webp"].some(r=>l.toLocaleLowerCase().includes(r))}const[T,z]=x({connectedComponent:ne}),[L,P]=x({connectedComponent:ae});return(l,t)=>{const r=U("a-button"),N=U("ghost-button"),c=ce("access");return d(),E(e(se),{"auto-content-height":!0},{default:i(()=>[m(e(h),{"table-title":"文件列表"},{"toolbar-tools":i(()=>[m(e(M),null,{default:i(()=>[m(e(X),{title:"预览图片"},{default:i(()=>[m(e(pe),{checked:I.value,"onUpdate:checked":t[0]||(t[0]=s=>I.value=s)},null,8,["checked"])]),_:1}),p((d(),E(r,{onClick:C},{default:i(()=>t[2]||(t[2]=[u(" 配置管理 ")])),_:1,__:[2]})),[[c,["system:ossConfig:list"],"code"]]),p((d(),E(r,{disabled:!e($)(e(n)),danger:"",type:"primary",onClick:B},{default:i(()=>[u(y(e(k)("pages.common.delete")),1)]),_:1},8,["disabled"])),[[c,["system:oss:remove"],"code"]]),p((d(),E(r,{onClick:e(P).open},{default:i(()=>t[3]||(t[3]=[u(" 文件上传 ")])),_:1,__:[3]},8,["onClick"])),[[c,["system:oss:upload"],"code"]]),p((d(),E(r,{onClick:e(z).open},{default:i(()=>t[4]||(t[4]=[u(" 图片上传 ")])),_:1,__:[4]},8,["onClick"])),[[c,["system:oss:upload"],"code"]])]),_:1})]),url:i(({row:s})=>[I.value&&j(s.url)?(d(),E(e(ie),{key:s.ossId,src:s.url,height:"50px",fallback:e(Be)},{placeholder:i(()=>[de("div",Ce,[m(e(Ae))])]),_:2},1032,["src","fallback"])):(d(),ge("span",he,y(s.url),1))]),action:i(({row:s})=>[m(e(M),null,{default:i(()=>[p((d(),E(N,{onClick:b=>f(s)},{default:i(()=>[u(y(e(k)("pages.common.download")),1)]),_:2},1032,["onClick"])),[[c,["system:oss:download"],"code"]]),m(e(Ee),{"get-popup-container":e(Qe),placement:"left",title:"确认删除？",onConfirm:b=>S(s)},{default:i(()=>[p((d(),E(N,{danger:"",onClick:t[1]||(t[1]=_(()=>{},["stop"]))},{default:i(()=>[u(y(e(k)("pages.common.delete")),1)]),_:1})),[[c,["system:oss:remove"],"code"]])]),_:2},1032,["get-popup-container","onConfirm"])]),_:2},1024)]),_:1}),m(e(T),{onReload:e(n).query},null,8,["onReload"]),m(e(L),{onReload:e(n).query},null,8,["onReload"])]),_:1})}}});export{$e as default};
