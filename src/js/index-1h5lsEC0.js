var K=Object.defineProperty;var P=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var V=(p,m,s)=>m in p?K(p,m,{enumerable:!0,configurable:!0,writable:!0,value:s}):p[m]=s,q=(p,m)=>{for(var s in m||(m={}))Q.call(m,s)&&V(p,s,m[s]);if(P)for(var s of P(m))X.call(m,s)&&V(p,s,m[s]);return p};var b=(p,m,s)=>new Promise((M,c)=>{var x=a=>{try{y(s.next(a))}catch(h){c(h)}},I=a=>{try{y(s.throw(a))}catch(h){c(h)}},y=a=>a.done?M(a.value):Promise.resolve(a.value).then(x,I);y((s=s.apply(p,m)).next())});import{bl as Z,aq as S,$ as g,al as ee}from"./bootstrap-CbEyMBZc.js";import{v as te}from"./vxe-table-5UTMlFMN.js";import{c as oe,e as re,h as T,i as ae}from"./index-CoycSe17.js";import"./vuedraggable.umd-Cwsj9bYW.js";import{_ as se}from"./table-switch.vue_vue_type_script_setup_true_lang-DjGnwzfb.js";import{c as ie}from"./download-BL_xY_mD.js";import{q as ne,c as me,_ as pe}from"./user-drawer.vue_vue_type_script_setup_true_lang-u4H7xBx-.js";import{_ as le}from"./dept-tree.vue_vue_type_script_setup_true_lang-BEss8Sse.js";import{_ as de}from"./user-import-modal.vue_vue_type_script_setup_true_lang-B0u81MNS.js";import{_ as ue}from"./user-info-modal.vue_vue_type_script_setup_true_lang-D0gTk8Ce.js";import{_ as ce}from"./user-reset-pwd-modal.vue_vue_type_script_setup_true_lang-BeM_5Oky.js";import U from"./index-Yd03BW_o.js";import{D as fe}from"./index-DWD1gEWB.js";import{M as ge,a as Y}from"./index-CQDwpHx9.js";import{A as _e}from"./index-CxSj1uA5.js";import{_ as Ce}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as ve,p as ye,l as B,V as he,h as _,o as d,w as r,j as ke,a as n,b as e,c as E,f as be,F as xe,W as C,k as u,t as v,a2 as De}from"../jse/index-index-CKHiV3bJ.js";import{u as w}from"./use-modal-BtBQhM0d.js";import{u as Me}from"./use-vxe-grid-jJsowVf7.js";import{u as Ie}from"./use-drawer-ZsTa9Rf6.js";import{P as we}from"./index-Bf3KtG2n.js";import{g as $e}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./index-CzyoVQCf.js";import"./index-xDQdt43_.js";import"./index-A9yvVzTO.js";import"./popup-DepLi2Z4.js";import"./data-cax7S9lw.js";import"./dict-LWP2femj.js";import"./index-D7oCs85i.js";import"./tree-DFBawhPd.js";import"./index-Bn5n5c2e.js";import"./Search-BSSOOXXu.js";import"./statusUtils-BVmAuBuf.js";import"./BaseInput-B-KbMaIq.js";import"./index-CWS-moKy.js";import"./SearchOutlined-wPvswOvm.js";import"./index-Bo5G3-h7.js";import"./index-B4Ee8RY3.js";import"./SyncOutlined-CaKwXa3d.js";import"./index-DcmIf06E.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./eagerComputed-ClTeoNNc.js";import"./index-CKqqy29x.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./relativeTime-C5B3Wg5z.js";import"./render-C2mFGEaj.js";import"./data-CsrVBQ4i.js";import"./index-BQy1gs98.js";import"./json-preview.vue_vue_type_style_index_0_lang-D-h_IPZe.js";import"./index-vRRmcGk_.js";import"./Dropdown-CEQGVhtH.js";import"./move-5_ATuUxE.js";import"./slide-BYSN4a27.js";import"./shallowequal-BSzQCceG.js";import"./uniq-DFnFScdj.js";import"./Overflow-1mM_ifyS.js";import"./index-7E7RpNGb.js";import"./x-C_lPlK2i.js";const Ae={class:"flex h-full gap-[8px]"},Gt=ve({__name:"index",setup(p){const[m,s]=w({connectedComponent:de});function M(){s.open()}const c=ye([]),x={schema:ne(),commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",handleReset:()=>b(null,null,function*(){c.value=[];const{formApi:o,reload:t}=a;yield o.resetForm();const l=o.form.values;o.setLatestSubmissionValues(l),yield t(l)}),fieldMappingTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},I={checkboxConfig:{highlight:!0,reserve:!0,trigger:"default",checkMethod:({row:o})=>(o==null?void 0:o.userId)!==1},columns:me,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(l,...R)=>b(null,[l,...R],function*({page:o},t={}){return c.value.length===1?t.deptId=c.value[0]:Reflect.deleteProperty(t,"deptId"),yield re(q({pageNum:o.currentPage,pageSize:o.pageSize},t))})}},headerCellConfig:{height:44},cellConfig:{height:48},rowConfig:{keyField:"userId"},id:"system-user-index"},[y,a]=Me({formOptions:x,gridOptions:I}),[h,D]=Ie({connectedComponent:pe});function N(){D.setData({}),D.open()}function F(o){D.setData({id:o.userId}),D.open()}function z(o){return b(this,null,function*(){yield T([o.userId]),yield a.query()})}function O(){const t=a.grid.getCheckboxRecords().map(l=>l.userId);ee.confirm({title:"提示",okType:"danger",content:`确认删除选中的${t.length}条记录吗？`,onOk:()=>b(null,null,function*(){yield T(t),yield a.query()})})}function j(){ie(ae,"用户管理",a.formApi.form.values,{fieldMappingTime:x.fieldMappingTime})}const[L,$]=w({connectedComponent:ue});function W(o){$.setData({userId:o.userId}),$.open()}const[G,A]=w({connectedComponent:ce});function H(o){A.setData({record:o}),A.open()}const{hasAccessByCodes:J}=Z();return(o,t)=>{const l=B("a-button"),R=B("ghost-button"),f=he("access");return d(),_(e(Ce),{"auto-content-height":!0},{default:r(()=>[ke("div",Ae,[n(le,{"select-dept-id":c.value,"onUpdate:selectDeptId":t[0]||(t[0]=i=>c.value=i),class:"w-[260px]",onReload:t[1]||(t[1]=()=>e(a).reload()),onSelect:t[2]||(t[2]=()=>e(a).reload())},null,8,["select-dept-id"]),n(e(y),{class:"flex-1 overflow-hidden","table-title":"用户列表"},{"toolbar-tools":r(()=>[n(e(U),null,{default:r(()=>[C((d(),_(l,{onClick:j},{default:r(()=>[u(v(e(g)("pages.common.export")),1)]),_:1})),[[f,["system:user:export"],"code"]]),C((d(),_(l,{onClick:M},{default:r(()=>[u(v(e(g)("pages.common.import")),1)]),_:1})),[[f,["system:user:import"],"code"]]),C((d(),_(l,{disabled:!e(te)(e(a)),danger:"",type:"primary",onClick:O},{default:r(()=>[u(v(e(g)("pages.common.delete")),1)]),_:1},8,["disabled"])),[[f,["system:user:remove"],"code"]]),C((d(),_(l,{type:"primary",onClick:N},{default:r(()=>[u(v(e(g)("pages.common.add")),1)]),_:1})),[[f,["system:user:add"],"code"]])]),_:1})]),avatar:r(({row:i})=>[n(e(_e),{src:i.avatar||e(De).app.defaultAvatar},null,8,["src"])]),status:r(({row:i})=>[n(e(se),{value:i.status,"onUpdate:value":k=>i.status=k,api:()=>e(oe)(i),disabled:i.userId===1||!e(J)(["system:user:edit"]),onReload:t[3]||(t[3]=()=>e(a).query())},null,8,["value","onUpdate:value","api","disabled"])]),action:r(({row:i})=>[i.userId!==1?(d(),E(xe,{key:0},[n(e(U),null,{default:r(()=>[C((d(),_(R,{onClick:S(k=>F(i),["stop"])},{default:r(()=>[u(v(e(g)("pages.common.edit")),1)]),_:2},1032,["onClick"])),[[f,["system:user:edit"],"code"]]),n(e(we),{"get-popup-container":e($e),placement:"left",title:"确认删除？",onConfirm:k=>z(i)},{default:r(()=>[C((d(),_(R,{danger:"",onClick:t[4]||(t[4]=S(()=>{},["stop"]))},{default:r(()=>[u(v(e(g)("pages.common.delete")),1)]),_:1})),[[f,["system:user:remove"],"code"]])]),_:2},1032,["get-popup-container","onConfirm"])]),_:2},1024),n(e(fe),{placement:"bottomRight"},{overlay:r(()=>[n(e(ge),null,{default:r(()=>[n(e(Y),{key:"1",onClick:k=>W(i)},{default:r(()=>t[7]||(t[7]=[u(" 用户信息 ")])),_:2,__:[7]},1032,["onClick"]),C((d(),E("span",null,[n(e(Y),{key:"2",onClick:k=>H(i)},{default:r(()=>t[8]||(t[8]=[u(" 重置密码 ")])),_:2,__:[8]},1032,["onClick"])])),[[f,["system:user:resetPwd"],"code"]])]),_:2},1024)]),default:r(()=>[n(l,{size:"small",type:"link"},{default:r(()=>[u(v(e(g)("pages.common.more")),1)]),_:1})]),_:2},1024)],64)):be("",!0)]),_:1})]),n(e(m),{onReload:t[5]||(t[5]=i=>e(a).query())}),n(e(h),{onReload:t[6]||(t[6]=i=>e(a).query())}),n(e(L)),n(e(G))]),_:1})}}});export{Gt as default};
