var c=(f,m,o)=>new Promise((s,i)=>{var d=a=>{try{n(o.next(a))}catch(r){i(r)}},t=a=>{try{n(o.throw(a))}catch(r){i(r)}},n=a=>a.done?s(a.value):Promise.resolve(a.value).then(d,t);n((o=o.apply(f,m)).next())});import{$ as p}from"./bootstrap-CbEyMBZc.js";import{u as h}from"./form-DcAycvJX.js";import{m as C,b as _,a as b,c as v}from"./data-MUe1_OS7.js";import{d as F,p as B,B as y,S as V,h as x,o as A,w as L,a as k,b as w}from"../jse/index-index-CKHiV3bJ.js";import{u as D}from"./use-modal-BtBQhM0d.js";const O=F({__name:"baseFile-modal",emits:["reload"],setup(f,{emit:m}){const o=m,s=B(!1),i=y(()=>s.value?p("pages.common.edit"):p("pages.common.add")),[d,t]=h({commonConfig:{formItemClass:"col-span-2",labelWidth:80,componentProps:{class:"w-full"}},schema:C(),showDefaultActions:!1,wrapperClass:"grid-cols-2"}),[n,a]=D({fullscreenButton:!1,onCancel:u,onConfirm:r,onOpenChange:l=>c(null,null,function*(){if(!l)return null;a.modalLoading(!0);const{id:e}=a.getData();if(s.value=!!e,s.value&&e){const g=yield _(e);yield t.setValues(g)}a.modalLoading(!1)})});function r(){return c(this,null,function*(){try{a.modalLoading(!0);const{valid:l}=yield t.validate();if(!l)return;const e=V(yield t.getValues());yield s.value?b(e):v(e),o("reload"),yield u()}catch(l){console.error(l)}finally{a.modalLoading(!1)}})}function u(){return c(this,null,function*(){a.close(),yield t.resetForm()})}return(l,e)=>(A(),x(w(n),{"close-on-click-modal":!1,title:i.value,class:"w-[550px]"},{default:L(()=>[k(w(d))]),_:1},8,["title"]))}});export{O as _};
