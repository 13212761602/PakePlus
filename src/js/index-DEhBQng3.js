var F=Object.defineProperty;var M=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var I=(p,i,a)=>i in p?F(p,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[i]=a,P=(p,i)=>{for(var a in i||(i={}))H.call(i,a)&&I(p,a,i[a]);if(M)for(var a of M(i))E.call(i,a)&&I(p,a,i[a]);return p};var g=(p,i,a)=>new Promise((D,r)=>{var N=d=>{try{w(a.next(d))}catch(v){r(v)}},_=d=>{try{w(a.throw(d))}catch(v){r(v)}},w=d=>d.done?D(d.value):Promise.resolve(d.value).then(N,_);w((a=a.apply(p,i)).next())});import{aG as X,aq as $,an as C,al as J}from"./bootstrap-CbEyMBZc.js";import{d as K,v as Q,l as U,V as Z,h as c,o as f,w as l,a as k,b as s,W as b,k as h,t as y,j as ee,X as te}from"../jse/index-index-CKHiV3bJ.js";import{v as x}from"./vxe-table-5UTMlFMN.js";import{g as oe,b as ae,s as ne,c as T,d as ie,f as Y}from"./index-DOqVB3Lq.js";import{d as S}from"./download-BL_xY_mD.js";import le from"./code-preview-modal-BV1tvEWa.js";import{_ as se}from"./table-import-modal.vue_vue_type_script_setup_true_lang-DNcs3aMK.js";import re from"./index-Yd03BW_o.js";import{_ as me}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{u as pe}from"./use-vxe-grid-jJsowVf7.js";import{u as z}from"./use-modal-BtBQhM0d.js";import{P as V}from"./index-Bf3KtG2n.js";import{g as q}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./code-mirror.vue_vue_type_script_setup_true_lang-DKbOgWua.js";import"./index-Bn5n5c2e.js";import"./index-DcmIf06E.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./index-B4Ee8RY3.js";import"./eagerComputed-ClTeoNNc.js";import"./index-CKqqy29x.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";const de=()=>[{component:"Select",fieldName:"dataName",label:"数据源",defaultValue:"",componentProps:{allowClear:!1}},{component:"Input",fieldName:"tableName",label:"表名称"},{component:"Input",fieldName:"tableComment",label:"表描述"},{component:"RangePicker",fieldName:"createTime",label:"创建时间"}],ce=[{type:"checkbox",width:60},{field:"tableName",title:"表名称"},{field:"tableComment",title:"表描述"},{field:"className",title:"实体类"},{field:"createTime",title:"创建时间"},{field:"updateTime",title:"更新时间"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:300}],Je=K({__name:"index",setup(p){const i={schema:de(),commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},a={checkboxConfig:{highlight:!0,reserve:!0,trigger:"row"},columns:ce,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(n,...o)=>g(null,[n,...o],function*({page:e},t={}){return yield ae(P({pageNum:e.currentPage,pageSize:e.pageSize},t))})}},rowConfig:{keyField:"tableId"},id:"tool-gen-index"},[D,r]=pe({formOptions:i,gridOptions:a});Q(()=>g(null,null,function*(){const e=yield oe(),t=[{label:"全部",value:""}],n=e.map(o=>({label:o,value:o}));t.push(...n),r.formApi.updateSchema([{fieldName:"dataName",componentProps:{options:t}}])}));const[N,_]=z({connectedComponent:le});function w(e){_.setData({tableId:e.tableId}),_.open()}const d=X();function v(e){d.push(`/code-gen/edit/${e.tableId}`)}function B(e){return g(this,null,function*(){yield ne(e.tableId),yield r.query()})}function R(){return g(this,null,function*(){const t=r.grid.getCheckboxRecords().map(o=>o.tableId);if(t.length===0){C.info("请选择需要生成代码的表");return}const n=C.loading("下载中...");try{const o=t.join(","),m=yield T(o),u=Date.now();S(m,`批量代码生成_${u}.zip`)}finally{n()}})}function O(e,t){return g(this,null,function*(){const n=C.loading("处理中...");try{if(e.genType==="1")return yield ie(e.tableId),C.success(`代码已生成到前端路径: ${e.genPathFront}, 后端路径: ${e.genPathBack}`),!1;{const o=yield T(e.tableId),m=te().format("YYYYMMDDHHmmss"),u=`代码生成_${e.tableName}_${m}.zip`;S(o,u),C.success("代码包下载成功")}}catch(o){return C.error((o==null?void 0:o.message)||"代码生成失败，请稍后重试"),console.error("代码生成失败:",o),!1}finally{n()}return!1})}function j(e){return g(this,null,function*(){yield Y(e.tableId),yield r.query()})}function A(){const t=r.grid.getCheckboxRecords().map(n=>n.tableId);J.confirm({title:"提示",okType:"danger",content:`确认删除选中的${t.length}条记录吗？`,onOk:()=>g(null,null,function*(){yield Y(t),yield r.query()})})}const[G,L]=z({connectedComponent:se});function W(){L.open()}return(e,t)=>{const n=U("a-button"),o=Z("access");return f(),c(s(me),{"auto-content-height":!0},{default:l(()=>[k(s(D),{"table-title":"代码生成列表"},{"toolbar-tools":l(()=>[t[3]||(t[3]=ee("a",{class:"text-primary mr-2",href:"https://dapdap.top/other/template.html",target:"_blank"},"👉关于代码生成模板 ",-1)),k(s(re),null,{default:l(()=>[b((f(),c(n,{disabled:!s(x)(s(r)),danger:"",type:"primary",onClick:A},{default:l(()=>[h(y(e.$t("pages.common.delete")),1)]),_:1},8,["disabled"])),[[o,["tool:gen:remove"],"code"]]),b((f(),c(n,{disabled:!s(x)(s(r)),onClick:R},{default:l(()=>[h(y(e.$t("pages.common.generate")),1)]),_:1},8,["disabled"])),[[o,["tool:gen:code"],"code"]]),b((f(),c(n,{type:"primary",onClick:W},{default:l(()=>[h(y(e.$t("pages.common.import")),1)]),_:1})),[[o,["tool:gen:import"],"code"]])]),_:1})]),action:l(({row:m})=>[b((f(),c(n,{size:"small",type:"link",onClick:$(u=>w(m),["stop"])},{default:l(()=>[h(y(e.$t("pages.common.preview")),1)]),_:2},1032,["onClick"])),[[o,["tool:gen:preview"],"code"]]),b((f(),c(n,{size:"small",type:"link",onClick:$(u=>v(m),["stop"])},{default:l(()=>[h(y(e.$t("pages.common.edit")),1)]),_:2},1032,["onClick"])),[[o,["tool:gen:edit"],"code"]]),k(s(V),{"get-popup-container":s(q),title:`确认同步[${m.tableName}]?`,placement:"left",onConfirm:u=>B(m)},{default:l(()=>[b((f(),c(n,{size:"small",type:"link",onClick:t[0]||(t[0]=$(()=>{},["stop"]))},{default:l(()=>[h(y(e.$t("pages.common.sync")),1)]),_:1})),[[o,["tool:gen:edit"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"]),b((f(),c(n,{size:"small",type:"link",onClick:$(u=>O(m),["stop"])},{default:l(()=>t[4]||(t[4]=[h(" 生成代码 ")])),_:2,__:[4]},1032,["onClick"])),[[o,["tool:gen:code"],"code"]]),k(s(V),{"get-popup-container":s(q),title:`确认删除[${m.tableName}]?`,placement:"left",onConfirm:u=>j(m)},{default:l(()=>[b((f(),c(n,{danger:"",size:"small",type:"link",onClick:t[1]||(t[1]=$(()=>{},["stop"]))},{default:l(()=>[h(y(e.$t("pages.common.delete")),1)]),_:1})),[[o,["tool:gen:remove"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"])]),_:1}),k(s(N)),k(s(G),{onReload:t[2]||(t[2]=m=>s(r).query())})]),_:1})}}});export{Je as default};
