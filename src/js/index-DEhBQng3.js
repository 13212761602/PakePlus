var F=Object.defineProperty;var M=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var I=(p,i,a)=>i in p?F(p,i,{enumerable:!0,configurable:!0,writable:!0,value:a}):p[i]=a,P=(p,i)=>{for(var a in i||(i={}))H.call(i,a)&&I(p,a,i[a]);if(M)for(var a of M(i))E.call(i,a)&&I(p,a,i[a]);return p};var g=(p,i,a)=>new Promise((D,r)=>{var N=d=>{try{w(a.next(d))}catch(v){r(v)}},_=d=>{try{w(a.throw(d))}catch(v){r(v)}},w=d=>d.done?D(d.value):Promise.resolve(d.value).then(N,_);w((a=a.apply(p,i)).next())});import{aG as X,aq as $,an as C,al as J}from"./bootstrap-CbEyMBZc.js";import{d as K,v as Q,l as U,V as Z,h as c,o as f,w as l,a as k,b as s,W as b,k as h,t as y,j as ee,X as te}from"../jse/index-index-CKHiV3bJ.js";import{v as x}from"./vxe-table-5UTMlFMN.js";import{g as oe,b as ae,s as ne,c as T,d as ie,f as Y}from"./index-DOqVB3Lq.js";import{d as S}from"./download-BL_xY_mD.js";import le from"./code-preview-modal-BV1tvEWa.js";import{_ as se}from"./table-import-modal.vue_vue_type_script_setup_true_lang-DNcs3aMK.js";import re from"./index-Yd03BW_o.js";import{_ as me}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{u as pe}from"./use-vxe-grid-jJsowVf7.js";import{u as z}from"./use-modal-BtBQhM0d.js";import{P as V}from"./index-Bf3KtG2n.js";import{g as q}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./code-mirror.vue_vue_type_script_setup_true_lang-DKbOgWua.js";import"./index-Bn5n5c2e.js";import"./index-DcmIf06E.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./index-B4Ee8RY3.js";import"./eagerComputed-ClTeoNNc.js";import"./index-CKqqy29x.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";const de=()=>[{component:"Select",fieldName:"dataName",label:"æ•°æ®æº",defaultValue:"",componentProps:{allowClear:!1}},{component:"Input",fieldName:"tableName",label:"è¡¨åç§°"},{component:"Input",fieldName:"tableComment",label:"è¡¨æè¿°"},{component:"RangePicker",fieldName:"createTime",label:"åˆ›å»ºæ—¶é—´"}],ce=[{type:"checkbox",width:60},{field:"tableName",title:"è¡¨åç§°"},{field:"tableComment",title:"è¡¨æè¿°"},{field:"className",title:"å®žä½“ç±»"},{field:"createTime",title:"åˆ›å»ºæ—¶é—´"},{field:"updateTime",title:"æ›´æ–°æ—¶é—´"},{field:"action",fixed:"right",slots:{default:"action"},title:"æ“ä½œ",width:300}],Je=K({__name:"index",setup(p){const i={schema:de(),commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",fieldMappingTime:[["createTime",["params[beginTime]","params[endTime]"],["YYYY-MM-DD 00:00:00","YYYY-MM-DD 23:59:59"]]]},a={checkboxConfig:{highlight:!0,reserve:!0,trigger:"row"},columns:ce,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(n,...o)=>g(null,[n,...o],function*({page:e},t={}){return yield ae(P({pageNum:e.currentPage,pageSize:e.pageSize},t))})}},rowConfig:{keyField:"tableId"},id:"tool-gen-index"},[D,r]=pe({formOptions:i,gridOptions:a});Q(()=>g(null,null,function*(){const e=yield oe(),t=[{label:"å…¨éƒ¨",value:""}],n=e.map(o=>({label:o,value:o}));t.push(...n),r.formApi.updateSchema([{fieldName:"dataName",componentProps:{options:t}}])}));const[N,_]=z({connectedComponent:le});function w(e){_.setData({tableId:e.tableId}),_.open()}const d=X();function v(e){d.push(`/code-gen/edit/${e.tableId}`)}function B(e){return g(this,null,function*(){yield ne(e.tableId),yield r.query()})}function R(){return g(this,null,function*(){const t=r.grid.getCheckboxRecords().map(o=>o.tableId);if(t.length===0){C.info("è¯·é€‰æ‹©éœ€è¦ç”Ÿæˆä»£ç çš„è¡¨");return}const n=C.loading("ä¸‹è½½ä¸­...");try{const o=t.join(","),m=yield T(o),u=Date.now();S(m,`æ‰¹é‡ä»£ç ç”Ÿæˆ_${u}.zip`)}finally{n()}})}function O(e,t){return g(this,null,function*(){const n=C.loading("å¤„ç†ä¸­...");try{if(e.genType==="1")return yield ie(e.tableId),C.success(`ä»£ç å·²ç”Ÿæˆåˆ°å‰ç«¯è·¯å¾„: ${e.genPathFront}, åŽç«¯è·¯å¾„: ${e.genPathBack}`),!1;{const o=yield T(e.tableId),m=te().format("YYYYMMDDHHmmss"),u=`ä»£ç ç”Ÿæˆ_${e.tableName}_${m}.zip`;S(o,u),C.success("ä»£ç åŒ…ä¸‹è½½æˆåŠŸ")}}catch(o){return C.error((o==null?void 0:o.message)||"ä»£ç ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•"),console.error("ä»£ç ç”Ÿæˆå¤±è´¥:",o),!1}finally{n()}return!1})}function j(e){return g(this,null,function*(){yield Y(e.tableId),yield r.query()})}function A(){const t=r.grid.getCheckboxRecords().map(n=>n.tableId);J.confirm({title:"æç¤º",okType:"danger",content:`ç¡®è®¤åˆ é™¤é€‰ä¸­çš„${t.length}æ¡è®°å½•å—ï¼Ÿ`,onOk:()=>g(null,null,function*(){yield Y(t),yield r.query()})})}const[G,L]=z({connectedComponent:se});function W(){L.open()}return(e,t)=>{const n=U("a-button"),o=Z("access");return f(),c(s(me),{"auto-content-height":!0},{default:l(()=>[k(s(D),{"table-title":"ä»£ç ç”Ÿæˆåˆ—è¡¨"},{"toolbar-tools":l(()=>[t[3]||(t[3]=ee("a",{class:"text-primary mr-2",href:"https://dapdap.top/other/template.html",target:"_blank"},"ðŸ‘‰å…³äºŽä»£ç ç”Ÿæˆæ¨¡æ¿ ",-1)),k(s(re),null,{default:l(()=>[b((f(),c(n,{disabled:!s(x)(s(r)),danger:"",type:"primary",onClick:A},{default:l(()=>[h(y(e.$t("pages.common.delete")),1)]),_:1},8,["disabled"])),[[o,["tool:gen:remove"],"code"]]),b((f(),c(n,{disabled:!s(x)(s(r)),onClick:R},{default:l(()=>[h(y(e.$t("pages.common.generate")),1)]),_:1},8,["disabled"])),[[o,["tool:gen:code"],"code"]]),b((f(),c(n,{type:"primary",onClick:W},{default:l(()=>[h(y(e.$t("pages.common.import")),1)]),_:1})),[[o,["tool:gen:import"],"code"]])]),_:1})]),action:l(({row:m})=>[b((f(),c(n,{size:"small",type:"link",onClick:$(u=>w(m),["stop"])},{default:l(()=>[h(y(e.$t("pages.common.preview")),1)]),_:2},1032,["onClick"])),[[o,["tool:gen:preview"],"code"]]),b((f(),c(n,{size:"small",type:"link",onClick:$(u=>v(m),["stop"])},{default:l(()=>[h(y(e.$t("pages.common.edit")),1)]),_:2},1032,["onClick"])),[[o,["tool:gen:edit"],"code"]]),k(s(V),{"get-popup-container":s(q),title:`ç¡®è®¤åŒæ­¥[${m.tableName}]?`,placement:"left",onConfirm:u=>B(m)},{default:l(()=>[b((f(),c(n,{size:"small",type:"link",onClick:t[0]||(t[0]=$(()=>{},["stop"]))},{default:l(()=>[h(y(e.$t("pages.common.sync")),1)]),_:1})),[[o,["tool:gen:edit"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"]),b((f(),c(n,{size:"small",type:"link",onClick:$(u=>O(m),["stop"])},{default:l(()=>t[4]||(t[4]=[h(" ç”Ÿæˆä»£ç  ")])),_:2,__:[4]},1032,["onClick"])),[[o,["tool:gen:code"],"code"]]),k(s(V),{"get-popup-container":s(q),title:`ç¡®è®¤åˆ é™¤[${m.tableName}]?`,placement:"left",onConfirm:u=>j(m)},{default:l(()=>[b((f(),c(n,{danger:"",size:"small",type:"link",onClick:t[1]||(t[1]=$(()=>{},["stop"]))},{default:l(()=>[h(y(e.$t("pages.common.delete")),1)]),_:1})),[[o,["tool:gen:remove"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"])]),_:1}),k(s(N)),k(s(G),{onReload:t[2]||(t[2]=m=>s(r).query())})]),_:1})}}});export{Je as default};
