var I=Object.defineProperty;var x=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var v=(r,o,e)=>o in r?I(r,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[o]=e,A=(r,o)=>{for(var e in o||(o={}))S.call(o,e)&&v(r,e,o[e]);if(x)for(var e of x(o))N.call(o,e)&&v(r,e,o[e]);return r};var f=(r,o,e)=>new Promise((h,c)=>{var y=a=>{try{m(e.next(a))}catch(p){c(p)}},s=a=>{try{m(e.throw(a))}catch(p){c(p)}},m=a=>a.done?h(a.value):Promise.resolve(a.value).then(y,s);m((e=e.apply(r,o)).next())});import{bh as P,aq as R,al as B}from"./bootstrap-CbEyMBZc.js";import{v as M}from"./vxe-table-5UTMlFMN.js";import{c as O,d as T,e as z}from"./index-BT9g_NIp.js";import{c as W,q as j,_ as F}from"./role-assign-drawer.vue_vue_type_script_setup_true_lang-C33TR16u.js";import G from"./index-Yd03BW_o.js";import{_ as L}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as E,l as $,V as H,h as g,o as C,w as i,a as _,b as n,W as k,k as w,t as J}from"../jse/index-index-CKHiV3bJ.js";import{u as K}from"./use-vxe-grid-jJsowVf7.js";import{u as Q}from"./use-drawer-ZsTa9Rf6.js";import{P as U}from"./index-Bf3KtG2n.js";import{g as X}from"./get-popup-container-P4S1sr5h.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./helper-CgBacOxF.js";import"./x-C_lPlK2i.js";import"./index-7E7RpNGb.js";const xe=E({__name:"index",setup(r){const e=P().params.roleId,h={commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},schema:j(),wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},c={checkboxConfig:{highlight:!0,reserve:!0},columns:W,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(d,...D)=>f(null,[d,...D],function*({page:l},t={}){return yield O(A({pageNum:l.currentPage,pageSize:l.pageSize,roleId:e},t))})}},rowConfig:{keyField:"userId"},id:"system-role-assign-index"},[y,s]=K({formOptions:h,gridOptions:c}),[m,a]=Q({connectedComponent:F});function p(){a.setData({}),a.open()}function q(l){return f(this,null,function*(){yield T({userId:l.userId,roleId:e}),yield s.query()})}function V(){const t=s.grid.getCheckboxRecords().map(d=>d.userId);B.confirm({title:"提示",okType:"danger",content:`确认取消选中的${t.length}条授权记录吗？`,onOk:()=>f(null,null,function*(){yield z(e,t),yield s.query(),s.grid.clearCheckboxRow()})})}return(l,t)=>{const d=$("a-button"),D=$("ghost-button"),b=H("access");return C(),g(n(L),{"auto-content-height":!0},{default:i(()=>[_(n(y),{"table-title":"已分配的用户列表"},{"toolbar-tools":i(()=>[_(n(G),null,{default:i(()=>[k((C(),g(d,{disabled:!n(M)(n(s)),danger:"",type:"primary",onClick:V},{default:i(()=>t[2]||(t[2]=[w(" 取消授权 ")])),_:1,__:[2]},8,["disabled"])),[[b,["system:role:remove"],"code"]]),k((C(),g(d,{type:"primary",onClick:p},{default:i(()=>[w(J(l.$t("pages.common.add")),1)]),_:1})),[[b,["system:role:add"],"code"]])]),_:1})]),action:i(({row:u})=>[_(n(U),{"get-popup-container":n(X),title:`是否取消授权用户[${u.userName} - ${u.nickName}]?`,placement:"left",onConfirm:Y=>q(u)},{default:i(()=>[k((C(),g(D,{danger:"",onClick:t[0]||(t[0]=R(()=>{},["stop"]))},{default:i(()=>t[3]||(t[3]=[w(" 取消授权 ")])),_:1,__:[3]})),[[b,["system:role:remove"],"code"]])]),_:2},1032,["get-popup-container","title","onConfirm"])]),_:1}),_(n(m),{onReload:t[1]||(t[1]=u=>n(s).query())})]),_:1})}}});export{xe as default};
