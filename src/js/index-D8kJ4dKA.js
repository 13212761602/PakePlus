var E=Object.defineProperty;var N=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var V=(n,e,i)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i,$=(n,e)=>{for(var i in e||(e={}))j.call(e,i)&&V(n,i,e[i]);if(N)for(var i of N(e))G.call(e,i)&&V(n,i,e[i]);return n};var c=(n,e,i)=>new Promise((y,u)=>{var f=m=>{try{g(i.next(m))}catch(r){u(r)}},C=m=>{try{g(i.throw(m))}catch(r){u(r)}},g=m=>m.done?y(m.value):Promise.resolve(m.value).then(f,C);g((i=i.apply(n,e)).next())});import{ap as L,aq as _,$ as H,al as J}from"./bootstrap-CbEyMBZc.js";import{v as K}from"./vxe-table-5UTMlFMN.js";import{p as B,d as D,a as Q}from"./index-BCj7hz3q.js";import{_ as X}from"./category-tree.vue_vue_type_script_setup_true_lang-Dm1xCFWN.js";import"./form-DcAycvJX.js";import"./approval-card.vue_vue_type_style_index_0_scoped_90981e93_lang-CFyUrHXN.js";/* empty css                                                          */import{_ as Y}from"./flow-info-modal.vue_vue_type_script_setup_true_lang-FIPeKqpQ.js";import"./vuedraggable.umd-Cwsj9bYW.js";import{_ as Z}from"./options-tag.vue_vue_type_script_setup_true_lang-ixeCQrr7.js";import{r as tt}from"./render-C2mFGEaj.js";import{a as et}from"./constant-CNx795op.js";import{a as l,d as ot,p as M,l as it,V as nt,h as W,o as h,w as s,j as k,b as a,c as at,f as rt,k as v,W as lt,t as st}from"../jse/index-index-CKHiV3bJ.js";import{_ as pt}from"./instance-invalid-modal.vue_vue_type_script_setup_true_lang-DP2qXQwS.js";import{_ as mt}from"./instance-variable-modal.vue_vue_type_script_setup_true_lang-DkSTOPVX.js";import dt from"./index-Yd03BW_o.js";import{_ as ct}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{u as ut}from"./use-vxe-grid-jJsowVf7.js";import{u as w}from"./use-modal-BtBQhM0d.js";import{P as ft}from"./index-Bf3KtG2n.js";import{g as gt}from"./get-popup-container-P4S1sr5h.js";import{a as vt}from"./Group-u_j2Tbqv.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./index-B9jrj9-y.js";import"./SyncOutlined-CaKwXa3d.js";import"./index-Bn5n5c2e.js";import"./Search-BSSOOXXu.js";import"./statusUtils-BVmAuBuf.js";import"./BaseInput-B-KbMaIq.js";import"./index-CWS-moKy.js";import"./SearchOutlined-wPvswOvm.js";import"./index-DcmIf06E.js";import"./index-C2Ye5jbl.js";import"./List-CkKZPkf7.js";import"./index-B4Ee8RY3.js";import"./eagerComputed-ClTeoNNc.js";import"./index-CKqqy29x.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./relativeTime-C5B3Wg5z.js";import"./approval-content.vue_vue_type_script_setup_true_lang-JZv4tt6H.js";import"./index-Bo5G3-h7.js";import"./approval-panel.vue_vue_type_script_setup_true_lang-B1awm_pt.js";import"./index-BCokd8-c.js";import"./approval-modal.vue_vue_type_script_setup_true_lang-r4oC-lZq.js";import"./copy-component.vue_vue_type_script_setup_true_lang-9yx0-G2y.js";import"./user-select-modal-CF4g6nsp.js";import"./index-CoycSe17.js";import"./helper-CgBacOxF.js";import"./dept-tree.vue_vue_type_script_setup_true_lang-BEss8Sse.js";import"./avatar.vue_vue_type_script_setup_true_lang-CZ6M6Zo9.js";import"./x-C_lPlK2i.js";import"./index-CxSj1uA5.js";import"./index-7E7RpNGb.js";import"./approval-details.vue_vue_type_script_setup_true_lang-CTP2jlly.js";import"./approval-timeline.vue_vue_type_script_setup_true_lang-CxoHRiMs.js";import"./approval-timeline-item.vue_vue_type_script_setup_true_lang-DbiUkk5H.js";import"./index-DMCjRHjH.js";import"./approval-rejection-modal.vue_vue_type_script_setup_true_lang-DB_t6bkD.js";import"./flow-interfere-modal.vue_vue_type_script_setup_true_lang-5N7VWWsA.js";import"./index-vRRmcGk_.js";import"./index-BPV6pKaP.js";import"./index-65hk_V-f.js";import"./index-CQDwpHx9.js";import"./shallowequal-BSzQCceG.js";import"./uniq-DFnFScdj.js";import"./Overflow-1mM_ifyS.js";import"./slide-BYSN4a27.js";import"./Dropdown-CEQGVhtH.js";import"./pick-DDCWWYz_.js";import"./isMobile-8sZ0LT6r.js";import"./index-DWD1gEWB.js";import"./move-5_ATuUxE.js";import"./fallback.vue_vue_type_script_setup_true_lang-ChoFPR3D.js";import"./rotate-cw-D3jx6xYy.js";import"./index-D7oCs85i.js";import"./index-cCfXrJ1Q.js";import"./index-BLUHc0Mr.js";import"./data-CsrVBQ4i.js";import"./index-BQy1gs98.js";import"./dict-LWP2femj.js";import"./json-preview.vue_vue_type_style_index_0_lang-D-h_IPZe.js";import"./Checkbox-CpVw4yVS.js";const _t=()=>[{component:"Input",label:"任务名称",fieldName:"nodeName"},{component:"Input",label:"流程名称",fieldName:"flowName"},{component:"Input",label:"流程编码",fieldName:"flowCode"}],yt=[{type:"checkbox",width:60},{field:"flowName",title:"流程名称",minWidth:150},{field:"nodeName",title:"任务名称",minWidth:150},{field:"flowCode",title:"流程编码",minWidth:150},{field:"createByName",title:"申请人",minWidth:150},{field:"version",title:"版本号",minWidth:150,formatter:({cellValue:n})=>`V${n}.0`},{field:"activityStatus",title:"状态",minWidth:100,slots:{default:({row:n})=>{const e=n.activityStatus;return l(Z,{options:et,value:e},null)}}},{field:"flowStatus",title:"流程状态",minWidth:100,slots:{default:({row:n})=>tt(n.flowStatus,L.WF_BUSINESS_STATUS)}},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",resizable:!1,width:200}],Ct={class:"flex h-full gap-[8px]"},bt={class:"flex flex-col"},ht={key:0},io=ot({__name:"index",setup(n){const e=M([]),i={schema:_t(),commonConfig:{labelWidth:80,componentProps:{allowClear:!0}},wrapperClass:"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",handleReset:()=>c(null,null,function*(){e.value=[];const{formApi:o,reload:t}=r;yield o.resetForm();const p=o.form.values;o.setLatestSubmissionValues(p),yield t(p)})},y=[{label:"运行中",value:"process_running"},{label:"已完成",value:"process_completed"}];let u=B;const f=M("process_running");function C(o){return c(this,null,function*(){const{value:t}=o.target;switch(t){case"process_completed":{u=Q;break}case"process_running":{u=B;break}}yield r.reload()})}const g={checkboxConfig:{highlight:!0,reserve:!0,trigger:"default"},columns:yt,height:"auto",keepSource:!0,pagerConfig:{},proxyConfig:{ajax:{query:(p,...U)=>c(null,[p,...U],function*({page:o},t={}){return e.value.length===1?t.category=e.value[0]:Reflect.deleteProperty(t,"category"),yield u($({pageNum:o.currentPage,pageSize:o.pageSize},t))})}},headerCellConfig:{height:44},cellConfig:{height:66},rowConfig:{keyField:"id"},id:"workflow-definition-index"},[m,r]=ut({formOptions:i,gridOptions:g}),[T,x]=w({connectedComponent:pt});function z(o){return c(this,null,function*(){x.setData({id:o.id}),x.open()})}function A(o){return c(this,null,function*(){yield D(o.id),yield r.query()})}function R(){const t=r.grid.getCheckboxRecords().map(p=>p.id);J.confirm({title:"提示",okType:"danger",content:`确认删除选中的${t.length}条记录吗？`,onOk:()=>c(null,null,function*(){yield D(t),yield r.query()})})}const[P,S]=w({connectedComponent:mt});function q(o){S.setData({record:o.variable}),S.open()}const[F,I]=w({connectedComponent:Y});function O(o){console.log(o),I.setData({businessId:o.businessId}),I.open()}return(o,t)=>{const p=it("a-button"),U=nt("access");return h(),W(a(ct),{"auto-content-height":!0},{default:s(()=>[k("div",Ct,[l(X,{"select-code":e.value,"onUpdate:selectCode":t[0]||(t[0]=d=>e.value=d),class:"w-[260px]",onReload:t[1]||(t[1]=()=>a(r).reload()),onSelect:t[2]||(t[2]=()=>a(r).reload())},null,8,["select-code"]),l(a(m),{class:"flex-1 overflow-hidden"},{"toolbar-actions":s(()=>[l(a(vt),{value:f.value,"onUpdate:value":t[3]||(t[3]=d=>f.value=d),options:y,"button-style":"solid","option-type":"button",onChange:C},null,8,["value"])]),"toolbar-tools":s(()=>[l(a(dt),null,{default:s(()=>[lt((h(),W(p,{disabled:!a(K)(a(r)),danger:"",type:"primary",onClick:R},{default:s(()=>[v(st(a(H)("pages.common.delete")),1)]),_:1},8,["disabled"])),[[U,["system:user:remove"],"code"]])]),_:1})]),action:s(({row:d})=>[k("div",bt,[f.value==="process_running"?(h(),at("div",ht,[l(p,{danger:"",size:"small",type:"link",onClick:_(b=>z(d),["stop"])},{default:s(()=>t[6]||(t[6]=[v(" 作废流程 ")])),_:2,__:[6]},1032,["onClick"]),l(a(ft),{"get-popup-container":a(gt),placement:"left",title:"确认删除？",onConfirm:b=>A(d)},{default:s(()=>[l(p,{danger:"",size:"small",type:"link",onClick:t[4]||(t[4]=_(()=>{},["stop"]))},{default:s(()=>t[7]||(t[7]=[v(" 删除流程 ")])),_:1,__:[7]})]),_:2},1032,["get-popup-container","onConfirm"])])):rt("",!0),k("div",null,[l(p,{size:"small",type:"link",onClick:_(b=>O(d),["stop"])},{default:s(()=>t[8]||(t[8]=[v(" 流程预览 ")])),_:2,__:[8]},1032,["onClick"]),l(p,{size:"small",type:"link",onClick:_(b=>q(d),["stop"])},{default:s(()=>t[9]||(t[9]=[v(" 变量查看 ")])),_:2,__:[9]},1032,["onClick"])])])]),_:1})]),l(a(T),{onReload:t[5]||(t[5]=()=>a(r).reload())}),l(a(P)),l(a(F))]),_:1})}}});export{io as default};
