var c=(e,p,a)=>new Promise((l,r)=>{var f=t=>{try{i(a.next(t))}catch(u){r(u)}},b=t=>{try{i(a.throw(t))}catch(u){r(u)}},i=t=>t.done?l(t.value):Promise.resolve(t.value).then(f,b);i((a=a.apply(e,p)).next())});import{y as m,$ as h}from"./bootstrap-CbEyMBZc.js";import{u as q}from"./form-DcAycvJX.js";import{c as x}from"./helper-CgBacOxF.js";import{g as d}from"./dict-LWP2femj.js";import{r as C}from"./render-C2mFGEaj.js";import{_ as v}from"./index.vue_vue_type_script_setup_true_lang-DD8R5ZD6.js";import{d as P,p as _,B as S,S as k,h as N,o as g,w as D,a as L,f as M,b as R}from"../jse/index-index-CKHiV3bJ.js";import{u as B}from"./use-modal-BtBQhM0d.js";function J(e){return m.get("/system/autoCodeRule/list",{params:e})}function K(e){return x("/system/autoCodeRule/export",e!=null?e:{})}function V(e){return m.get(`/system/autoCodeRule/${e}`)}function $(e){return m.postWithMsg("/system/autoCodeRule",e)}function A(e){return m.putWithMsg("/system/autoCodeRule",e)}function Q(e){return m.deleteWithMsg(`/system/autoCodeRule/${e}`)}const X=()=>[{component:"Input",fieldName:"ruleCode",label:"规则编码"},{component:"Input",fieldName:"ruleName",label:"规则名称"},{component:"Input",fieldName:"ruleDesc",label:"描述"},{component:"Select",componentProps:{options:d("sys_module_type")},fieldName:"moduleCode",label:"所属模块"},{component:"Input",fieldName:"maxLength",label:"最大长度"},{component:"Select",componentProps:{options:d("sys_yes_no")},fieldName:"isPadded",label:"是否补齐"},{component:"Input",fieldName:"paddedChar",label:"补齐字符"},{component:"Input",fieldName:"paddedMethod",label:"补齐方式"},{component:"Select",componentProps:{options:d("sys_normal_disable")},fieldName:"status",label:"状态"}],Y=[{type:"checkbox",width:60},{title:"主键",field:"id"},{title:"规则编码",field:"ruleCode"},{title:"规则名称",field:"ruleName"},{title:"描述",field:"ruleDesc"},{title:"所属模块",field:"moduleCode",slots:{default:({row:e})=>C(e.moduleCode,"sys_module_type")}},{title:"最大长度",field:"maxLength"},{title:"是否补齐",field:"isPadded",slots:{default:({row:e})=>C(e.isPadded,"sys_yes_no")}},{title:"补齐字符",field:"paddedChar"},{title:"补齐方式",field:"paddedMethod"},{title:"状态",field:"status",slots:{default:({row:e})=>C(e.status,"sys_normal_disable")}},{title:"备注",field:"remark"},{field:"action",fixed:"right",slots:{default:"action"},title:"操作",width:180}],F=()=>[{label:"主键",fieldName:"id",component:"Input",dependencies:{show:()=>!1,triggerFields:[""]}},{label:"规则编码",fieldName:"ruleCode",component:"Input",rules:"required"},{label:"规则名称",fieldName:"ruleName",component:"Input",rules:"required"},{label:"描述",fieldName:"ruleDesc",component:"Input",rules:"required"},{label:"所属模块",fieldName:"moduleCode",component:"Select",componentProps:{options:d("sys_module_type")},rules:"selectRequired"},{label:"最大长度",fieldName:"maxLength",component:"Input",rules:"required"},{label:"是否补齐",fieldName:"isPadded",component:"Select",componentProps:{options:d("sys_yes_no")},rules:"selectRequired"},{label:"补齐字符",fieldName:"paddedChar",component:"Input",rules:"required"},{label:"补齐方式",fieldName:"paddedMethod",component:"Input",rules:"required"},{label:"状态",fieldName:"status",component:"Select",componentProps:{options:d("sys_normal_disable")},rules:"selectRequired"},{label:"备注",fieldName:"remark",component:"Input",rules:"required"}],Z=P({__name:"autoCodeRule-modal",emits:["reload"],setup(e,{emit:p}){const a=p,l=_(!1),r=_(),f=_(),b=S(()=>l.value?h("pages.common.edit"):h("pages.common.add")),[i,t]=q({schema:F(),showDefaultActions:!1,wrapperClass:"grid-cols-4"}),[u,n]=B({fullscreenButton:!1,onCancel:y,onConfirm:I,onOpenChange:s=>c(null,null,function*(){if(!s)return null;n.modalLoading(!0);const{id:o}=n.getData();if(l.value=!!o,r.value=o,l.value&&o){const w=yield V(o);yield t.setValues(w)}n.modalLoading(!1)})});function I(){return c(this,null,function*(){try{n.modalLoading(!0);const{valid:s}=yield t.validate();if(!s)return;const o=k(yield t.getValues());yield l.value?A(o):$(o),a("reload"),yield y()}catch(s){console.error(s)}finally{n.modalLoading(!1)}})}function y(){return c(this,null,function*(){n.close(),yield t.resetForm()})}return(s,o)=>(g(),N(R(u),{"close-on-click-modal":!1,title:b.value,class:"w-[1200px]"},{default:D(()=>[L(R(i)),l.value?(g(),N(v,{key:0,ref_key:"subTableRef",ref:f,"search-params":{ruleId:r.value},"embedded-mode":""},null,8,["search-params"])):M("",!0)]),_:1},8,["title"]))}});export{Z as _,J as a,Q as b,Y as c,K as d,X as q};
