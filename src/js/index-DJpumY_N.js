var Re=Object.defineProperty,Ae=Object.defineProperties;var ke=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var Ee=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var I=(e,n,t)=>n in e?Re(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,j=(e,n)=>{for(var t in n||(n={}))Ee.call(n,t)&&I(e,t,n[t]);if(D)for(var t of D(n))_e.call(n,t)&&I(e,t,n[t]);return e},z=(e,n)=>Ae(e,ke(n));var P=(e,n,t)=>new Promise((o,r)=>{var u=a=>{try{s(t.next(a))}catch(c){r(c)}},d=a=>{try{s(t.throw(a))}catch(c){r(c)}},s=a=>a.done?o(a.value):Promise.resolve(a.value).then(u,d);s((t=t.apply(e,n)).next())});import{q as U,d as Y,a4 as Ue,p as $,v as Me,ah as Oe,U as $e,aC as we,M as N,I as w,m as B,u as Le,C as Ve,B as A,a2 as De,a3 as Ie,c as je,o as T,a as ze,w as Pe,h as Ne,f as Be,b as H,R as Te,ar as He}from"../jse/index-index-CKHiV3bJ.js";import{e$ as Ze,f0 as M,cl as We,u as Ke}from"./bootstrap-CbEyMBZc.js";import{S as Fe}from"./index-BQy1gs98.js";function qe(e,n,t){var o=e.length;return t=t===void 0?o:t,Ze(e,n,t)}var Ge="\\ud800-\\udfff",Je="\\u0300-\\u036f",Ye="\\ufe20-\\ufe2f",Qe="\\u20d0-\\u20ff",Xe=Je+Ye+Qe,en="\\ufe0e\\ufe0f",nn="\\u200d",tn=RegExp("["+nn+Ge+Xe+en+"]");function Q(e){return tn.test(e)}function rn(e){return e.split("")}var X="\\ud800-\\udfff",an="\\u0300-\\u036f",on="\\ufe20-\\ufe2f",un="\\u20d0-\\u20ff",sn=an+on+un,ln="\\ufe0e\\ufe0f",dn="["+X+"]",L="["+sn+"]",V="\\ud83c[\\udffb-\\udfff]",cn="(?:"+L+"|"+V+")",ee="[^"+X+"]",ne="(?:\\ud83c[\\udde6-\\uddff]){2}",te="[\\ud800-\\udbff][\\udc00-\\udfff]",fn="\\u200d",re=cn+"?",ae="["+ln+"]?",mn="(?:"+fn+"(?:"+[ee,ne,te].join("|")+")"+ae+re+")*",vn=ae+re+mn,gn="(?:"+[ee+L+"?",L,ne,te,dn].join("|")+")",pn=RegExp(V+"(?="+V+")|"+gn+vn,"g");function bn(e){return e.match(pn)||[]}function xn(e){return Q(e)?bn(e):rn(e)}function yn(e){return function(n){n=M(n);var t=Q(n)?xn(n):void 0,o=t?t[0]:n.charAt(0),r=t?qe(t,1).join(""):n.slice(1);return o[e]()+r}}var hn=yn("toUpperCase");function Cn(e){return hn(M(e).toLowerCase())}function Sn(e,n,t,o){for(var r=-1,u=e==null?0:e.length;++r<u;)t=n(t,e[r],r,e);return t}function Rn(e){return function(n){return e==null?void 0:e[n]}}var An={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},kn=Rn(An),En=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,_n="\\u0300-\\u036f",Un="\\ufe20-\\ufe2f",Mn="\\u20d0-\\u20ff",On=_n+Un+Mn,$n="["+On+"]",wn=RegExp($n,"g");function Ln(e){return e=M(e),e&&e.replace(En,kn).replace(wn,"")}var Vn=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function Dn(e){return e.match(Vn)||[]}var In=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function jn(e){return In.test(e)}var oe="\\ud800-\\udfff",zn="\\u0300-\\u036f",Pn="\\ufe20-\\ufe2f",Nn="\\u20d0-\\u20ff",Bn=zn+Pn+Nn,ue="\\u2700-\\u27bf",ie="a-z\\xdf-\\xf6\\xf8-\\xff",Tn="\\xac\\xb1\\xd7\\xf7",Hn="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Zn="\\u2000-\\u206f",Wn=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",se="A-Z\\xc0-\\xd6\\xd8-\\xde",Kn="\\ufe0e\\ufe0f",le=Tn+Hn+Zn+Wn,de="['’]",Z="["+le+"]",Fn="["+Bn+"]",ce="\\d+",qn="["+ue+"]",fe="["+ie+"]",me="[^"+oe+le+ce+ue+ie+se+"]",Gn="\\ud83c[\\udffb-\\udfff]",Jn="(?:"+Fn+"|"+Gn+")",Yn="[^"+oe+"]",ve="(?:\\ud83c[\\udde6-\\uddff]){2}",ge="[\\ud800-\\udbff][\\udc00-\\udfff]",C="["+se+"]",Qn="\\u200d",W="(?:"+fe+"|"+me+")",Xn="(?:"+C+"|"+me+")",K="(?:"+de+"(?:d|ll|m|re|s|t|ve))?",F="(?:"+de+"(?:D|LL|M|RE|S|T|VE))?",pe=Jn+"?",be="["+Kn+"]?",et="(?:"+Qn+"(?:"+[Yn,ve,ge].join("|")+")"+be+pe+")*",nt="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",tt="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",rt=be+pe+et,at="(?:"+[qn,ve,ge].join("|")+")"+rt,ot=RegExp([C+"?"+fe+"+"+K+"(?="+[Z,C,"$"].join("|")+")",Xn+"+"+F+"(?="+[Z,C+W,"$"].join("|")+")",C+"?"+W+"+"+K,C+"+"+F,tt,nt,ce,at].join("|"),"g");function ut(e){return e.match(ot)||[]}function it(e,n,t){return e=M(e),n=n,n===void 0?jn(e)?ut(e):Dn(e):e.match(n)||[]}var st="['’]",lt=RegExp(st,"g");function dt(e){return function(n){return Sn(it(Ln(n).replace(lt,"")),e,"")}}var ct=dt(function(e,n,t){return n=n.toLowerCase(),e+(t?Cn(n):n)}),ft=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCommentChange","onCompositionEnd","onCompositionStart","onCompositionUpdate","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onInput","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],mt=function(e){return ft.map(function(n){return n.toLowerCase()}).indexOf(e.toLowerCase())!==-1},vt=function(e,n,t){Object.keys(n).filter(mt).forEach(function(o){var r=n[o];typeof r=="function"&&(o==="onInit"?r(e,t):t.on(o.substring(2),function(u){return r(u,t)}))})},gt=function(e,n,t,o){var r=e.modelEvents?e.modelEvents:null,u=Array.isArray(r)?r.join(" "):r;U(o,function(d,s){t&&typeof d=="string"&&d!==s&&d!==t.getContent({format:e.outputFormat})&&t.setContent(d)}),t.on(u||"change input undo redo",function(){n.emit("update:modelValue",t.getContent({format:e.outputFormat}))})},pt=function(e,n,t,o,r,u){o.setContent(u()),t.attrs["onUpdate:modelValue"]&&gt(n,t,o,r),vt(e,t.attrs,o)},q=0,xe=function(e){var n=Date.now(),t=Math.floor(Math.random()*1e9);return q++,e+"_"+t+q+String(n)},bt=function(e){return e!==null&&e.tagName.toLowerCase()==="textarea"},G=function(e){return typeof e=="undefined"||e===""?[]:Array.isArray(e)?e:e.split(" ")},xt=function(e,n){return G(e).concat(G(n))},yt=function(e){return e==null},J=function(){return{listeners:[],scriptId:xe("tiny-script"),scriptLoaded:!1}},ht=function(){var e=J(),n=function(r,u,d,s){var a=u.createElement("script");a.referrerPolicy="origin",a.type="application/javascript",a.id=r,a.src=d;var c=function(){a.removeEventListener("load",c),s()};a.addEventListener("load",c),u.head&&u.head.appendChild(a)},t=function(r,u,d){e.scriptLoaded?d():(e.listeners.push(d),r.getElementById(e.scriptId)||n(e.scriptId,r,u,function(){e.listeners.forEach(function(s){return s()}),e.scriptLoaded=!0}))},o=function(){e=J()};return{load:t,reinitialize:o}},Ct=ht(),St=function(){return typeof window!="undefined"?window:global},x=function(){var e=St();return e&&e.tinymce?e.tinymce:null},Rt={apiKey:String,licenseKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(e){return e==="html"||e==="text"}}},f=function(){return f=Object.assign||function(e){for(var n,t=1,o=arguments.length;t<o;t++){n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},f.apply(this,arguments)},At=function(e,n,t,o){return e(o||"div",{id:n,ref:t})},kt=function(e,n,t){return e("textarea",{id:n,visibility:"hidden",ref:t})},O={selector:void 0,target:void 0},Et=Y({props:Rt,setup:function(e,n){var t=e.init?f(f({},e.init),O):f({},O),o=Ue(e),r=o.disabled,u=o.modelValue,d=o.tagName,s=$(null),a=null,c=e.id||xe("tiny-vue"),S=e.init&&e.init.inline||e.inline,R=!!n.attrs["onUpdate:modelValue"],g=!0,k=e.initialValue?e.initialValue:"",y="",E=function(i){return R?function(){return u!=null&&u.value?u.value:""}:function(){return i?k:y}},p=function(){var i=E(g),l=f(f({},t),{readonly:e.disabled,target:s.value,plugins:xt(t.plugins,e.plugins),toolbar:e.toolbar||t.toolbar,inline:S,license_key:e.licenseKey,setup:function(v){a=v,v.on("init",function(h){return pt(h,e,n,v,u,i)}),typeof t.setup=="function"&&t.setup(v)}});bt(s.value)&&(s.value.style.visibility=""),x().init(l),g=!1};U(r,function(i){var l;a!==null&&(typeof((l=a.mode)===null||l===void 0?void 0:l.set)=="function"?a.mode.set(i?"readonly":"design"):a.setMode(i?"readonly":"design"))}),U(d,function(i){var l;R||(y=a.getContent()),(l=x())===null||l===void 0||l.remove(a),w(function(){return p()})}),Me(function(){if(x()!==null)p();else if(s.value&&s.value.ownerDocument){var i=e.cloudChannel?e.cloudChannel:"7",l=e.apiKey?e.apiKey:"no-api-key",v=yt(e.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/".concat(l,"/tinymce/").concat(i,"/tinymce.min.js"):e.tinymceScriptSrc;Ct.load(s.value.ownerDocument,v,p)}}),Oe(function(){x()!==null&&x().remove(a)}),S||($e(function(){g||p()}),we(function(){var i;R||(y=a.getContent()),(i=x())===null||i===void 0||i.remove(a)}));var m=function(i){var l;y=a.getContent(),(l=x())===null||l===void 0||l.remove(a),t=f(f(f({},t),i),O),w(function(){return p()})};return n.expose({rerender:m,getEditor:function(){return a}}),function(){return S?At(N,c,s,e.tagName):kt(N,c,s)}}});const _t="preview importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media codesample table charmap pagebreak nonbreaking anchor insertdatetime advlist lists wordcount help charmap emoticons accordion",Ut="undo redo | accordion accordionremove | blocks fontfamily fontsize | bold italic underline strikethrough | align numlist bullist | link image | table media | lineheight outdent indent| forecolor backcolor removeformat | charmap emoticons | code fullscreen preview | save print | pagebreak anchor codesample | ltr rtl",Mt={class:"app-tinymce"},Dt=Y({name:"Tinymce",inheritAttrs:!1,__name:"editor",props:B({height:{default:400},options:{default:()=>({})},plugins:{default:_t},toolbar:{default:Ut},disabled:{type:Boolean,default:!1}},{modelValue:{default:""},modelModifiers:{}}),emits:B(["mounted"],["update:modelValue"]),setup(e,{emit:n}){const t=e,o=n,r="/tinymce/tinymce.min.js",u=Le(e,"modelValue"),d=Ve(null),{isDark:s,locale:a}=We(),c=A(()=>s.value?"oxide-dark":"oxide"),S=A(()=>s.value?"dark":"default"),R=A(()=>De.app.locale.replace("-","_").includes("en_US")?"en":"zh_CN"),g=$(!0);U([s,a],()=>P(null,null,function*(){d.value&&(d.value.destroy(),g.value=!1,yield w(),g.value=!0)}));const k=$(!0),y=A(()=>{const{height:m,options:i,plugins:l,toolbar:v}=t;return z(j({auto_focus:!0,branding:!1,content_css:S.value,content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:16px }",contextmenu:"link image table",default_link_target:"_blank",height:m,image_advtab:!0,image_caption:!0,importcss_append:!0,language:R.value,link_title:!1,menubar:"file edit view insert format tools table help",noneditable_class:"mceNonEditable",paste_data_images:!0,images_file_types:"jpeg,jpg,png,gif,bmp,webp",plugins:l,quickbars_selection_toolbar:"bold italic | quicklink h2 h3 blockquote quickimage quicktable",skin:c.value,toolbar:v,toolbar_mode:"sliding"},i),{images_upload_handler:(h,ye)=>new Promise((he,Ce)=>{const Se=h.blob();Ke(Se,{onUploadProgress:b=>{const _=Math.trunc(b.loaded/b.total*100);ye(_)}}).then(b=>{const{url:_}=b;console.log("tinymce上传图片:",_),he(_)}).catch(b=>{console.error("tinymce上传图片失败:",b),Ce({message:b.message,remove:!0})})}),setup:h=>{d.value=h,h.on("init",()=>{o("mounted"),k.value=!1})}})}),E=Ie(),p=A(()=>{const m={};for(const i in E)if(i.startsWith("on")){const l=ct(i.split("on")[1]);m[l]=E[i]}return m});return(m,i)=>(T(),je("div",Mt,[ze(H(Fe),{spinning:k.value},{default:Pe(()=>[g.value?(T(),Ne(H(Et),Te({key:0,modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=l=>u.value=l),init:y.value,"tinymce-script-src":r,disabled:m.disabled,"license-key":"gpl"},He(p.value)),null,16,["modelValue","init","disabled"])):Be("",!0)]),_:1},8,["spinning"])]))}});export{Dt as Tinymce};
