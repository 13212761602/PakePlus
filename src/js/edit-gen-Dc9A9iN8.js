var j=Object.defineProperty,z=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var w=(o,e,t)=>e in o?j(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,x=(o,e)=>{for(var t in e||(e={}))K.call(e,t)&&w(o,t,e[t]);if(S)for(var t of S(e))L.call(e,t)&&w(o,t,e[t]);return o},V=(o,e)=>z(o,G(e));var C=(o,e,t)=>new Promise((h,_)=>{var l=a=>{try{p(t.next(a))}catch(g){_(g)}},c=a=>{try{p(t.throw(a))}catch(g){_(g)}},p=a=>a.done?h(a.value):Promise.resolve(a.value).then(l,c);p((t=t.apply(o,e)).next())});import{bh as O,aG as Q}from"./bootstrap-CbEyMBZc.js";import{a as U,e as A}from"./index-DOqVB3Lq.js";import{_ as H}from"./basic-setting.vue_vue_type_script_setup_true_lang-BHMMQMMm.js";import{_ as J}from"./gen-config.vue_vue_type_script_setup_true_lang-CvX7vYnf.js";import{C as W}from"./index-BPV6pKaP.js";import{a as X,T as N}from"./index-65hk_V-f.js";import{S as Y}from"./index-Bn5n5c2e.js";import{_ as Z}from"./page.vue_vue_type_script_setup_true_lang-C6V6VPKH.js";import{d as ee,p as M,ag as te,v as oe,E as q,l as re,h as k,o as T,w as u,b as n,a as d,k as ae,S as ie}from"../jse/index-index-CKHiV3bJ.js";import{u as ne}from"./use-tabs-CTpa-Bfa.js";import"./helper-CgBacOxF.js";import"./index-B7PFKwMa.js";import"./form-DcAycvJX.js";import"./use-vben-form-CDDuv56b.js";import"./index-C0ExvxMt.js";import"./checkbox.vue_vue_type_script_setup_true_lang-53DrAgf8.js";import"./render-content.vue_vue_type_script_lang-h-IJYrAt.js";import"./get-popup-container-P4S1sr5h.js";import"./index-CGauSucA.js";import"./tree-DFBawhPd.js";import"./vxe-table-5UTMlFMN.js";import"./init-5GXIIGpx.js";import"./index-CUsW12bK.js";import"./css-Dmgy8YJo.js";import"./LeftOutlined-D2uSfO0F.js";import"./dict-type-DToMJXi_.js";import"./index-Bo5G3-h7.js";import"./Search-BSSOOXXu.js";import"./statusUtils-BVmAuBuf.js";import"./BaseInput-B-KbMaIq.js";import"./index-CWS-moKy.js";import"./SearchOutlined-wPvswOvm.js";import"./index-B4Ee8RY3.js";import"./index-B-PgKNNy.js";import"./index-C-6YIAWO.js";import"./Overflow-1mM_ifyS.js";import"./List-CkKZPkf7.js";import"./isMobile-8sZ0LT6r.js";import"./DownOutlined-C0xNNL43.js";import"./move-5_ATuUxE.js";import"./slide-BYSN4a27.js";import"./useMemo-DU68JpYs.js";import"./index-1qAxlhJj.js";import"./Checkbox-CpVw4yVS.js";import"./index-CKqqy29x.js";import"./use-vxe-grid-jJsowVf7.js";import"./index-CQDwpHx9.js";import"./shallowequal-BSzQCceG.js";import"./uniq-DFnFScdj.js";import"./Dropdown-CEQGVhtH.js";import"./pick-DDCWWYz_.js";function se(o){const e=Number(o);return Number.isSafeInteger(e)?e:o}const st=ee({__name:"edit-gen",setup(o){const{setTabTitle:e,closeCurrentTab:t}=ne(),_=O().params.tableId,l=M();te("genInfoData",l),oe(()=>C(null,null,function*(){const s=yield U(_);s.info.parentMenuId=se(s.info.parentMenuId),l.value=s.info,e(`生成配置: ${s.info.tableName}`)}));const c=M("setting"),p=q("basicSettingRef"),a=q("genConfigRef"),g=Q();function D(){return C(this,null,function*(){var s,m,b,v,I;try{if(!(yield(s=p.value)==null?void 0:s.validateForm())){c.value="setting";return}if(!(yield(m=a.value)==null?void 0:m.validateTable())){c.value="fields";return}const r=ie(n(l)),E=yield(b=p.value)==null?void 0:b.getFormValues();if(Object.assign(r,E),r.columns=(I=(v=a.value)==null?void 0:v.getTableRecords())!=null?I:[],r&&r.tplCategory==="tree"){const{treeCode:f,treeName:i,treeParentCode:y}=r;r.params={treeCode:f,treeName:i,treeParentCode:y}}if(r){const f=i=>i?"1":"0";r.columns.forEach(i=>{const{edit:y,insert:$,query:P,required:B,list:F}=i;i.isInsert=f($),i.isEdit=f(y),i.isList=f(F),i.isQuery=f(P),i.isRequired=f(B)}),r.params=V(x({},r.params),{parentMenuId:r.parentMenuId,popupComponent:r.popupComponent,formComponent:r.formComponent})}yield A(r),yield t(),g.push({path:"/system/tool/gen",replace:!0})}catch(R){console.error(R)}})}return(s,m)=>{const b=re("a-button");return T(),k(n(Z),{"auto-content-height":!0},{default:u(()=>[l.value?(T(),k(n(W),{key:0,class:"h-full","body-style":{padding:"0 16px 16px"},style:{height:"800px"}},{default:u(()=>[d(n(X),{"active-key":c.value,"onUpdate:activeKey":m[0]||(m[0]=v=>c.value=v),size:"middle"},{rightExtra:u(()=>[d(b,{type:"primary",onClick:D},{default:u(()=>m[1]||(m[1]=[ae("保存配置")])),_:1,__:[1]})]),default:u(()=>[d(n(N),{key:"setting",tab:"生成信息","force-render":!0},{default:u(()=>[d(n(H),{ref_key:"basicSettingRef",ref:p},null,512)]),_:1}),d(n(N),{key:"fields",tab:"字段信息","force-render":!0},{default:u(()=>[d(n(J),{ref_key:"genConfigRef",ref:a},null,512)]),_:1})]),_:1},8,["active-key"])]),_:1})):(T(),k(n(Y),{key:1,active:!0}))]),_:1})}}});export{st as default};
